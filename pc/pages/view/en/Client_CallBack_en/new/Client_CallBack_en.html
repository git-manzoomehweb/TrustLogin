<basis core="external.fly.ws" procedurename="dbsource" source="cmsDbService2" name="db">
    <member name="get_unit_currency" method="cms" query='{
        "name": "db",
        "mid": "20",
        "member": [
            {
                "type": "list",
                "dmnid": "[##cms.cms.domainid##]",
                "name": "q",
                "lid": "2",
                "request": "get_unit_currency"
            }
        ]
    }' />
</basis>
<basis core="group" name="Delay_0">
    <basis core='inlinesource' name='db'>
        <member name='unit_title' format="json" preview=""
            postsql="select value from [db.unit_title] where field = 'title'">
            {"root": [##db.get_unit_currency.result##]}
        </member>
    </basis>
    <basis core="dbsource" source="hosting" name="site">
        <member name="address" type="list" request="siteaddress" preview="" />
    </basis>
    <basis core="external.fly.ws" source="cmsDbService2" procedurename="dbsource" name="db">
        <member name="get_inputs" method="cms" query='{
       "name": "db",
       "mid": "20",
       "member": [
           {
               "request": "get_inputs",
               "id": "[##cms.form.ResNum|cms.form.SaleOrderId|cms.query.iN|cms.query.Authority|cms.query.invoiceNumber|cms.form.payment_token|cms.form.OrderId|cms.form.transid|cms.form.traceNumber|cms.query.ResNum|cms.query.localInvoiceId|cms.form.requestId|cms.query.token|cms.query.invoiceId|cms.form.transactionId##]"
           }
       ]
     }' preview="" />
    </basis>
    <basis core="group" name="Delay_1">
        <basis core="inlinesource" name="db">
            <member name="get_inputs_id" format="json"
                postsql="select  value  from [db.get_inputs_id] as a where Field = 'id'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_trackingid" format="json"
                postsql="select  value  from [db.get_inputs_trackingid] as a where Field = 'trackingid'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_rkey" format="json"
                postsql="select  value  from [db.get_inputs_rkey] as a where Field = 'rkey'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_factorid" format="json"
                postsql="select  value  from [db.get_inputs_factorid] as a where Field = 'factorid'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_agencyid" format="json"
                postsql="select  value  from [db.get_inputs_agencyid] as a where Field = 'agencyid'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_paytype" format="json"
                postsql="select  value  from [db.get_inputs_paytype] as a where Field = 'paytype'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_totalfinal" format="json"
                postsql="select  value  from [db.get_inputs_totalfinal] as a where Field = 'totalfinal'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_supplier" format="json"
                postsql="select  value  from [db.get_inputs_supplier] as a where Field = 'supplier'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_bank_id" format="json"
                postsql="select  value  from [db.get_inputs_bank_id] as a where Field = 'bank_id'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_bankid" format="json"
                postsql="select  value  from [db.get_inputs_bankid] as a where Field = 'bankid'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_paymentid" format="json"
                postsql="select  value  from [db.get_inputs_paymentid] as a where Field = 'paymentid'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_factortype" format="json"
                postsql="select  value  from [db.get_inputs_factortype] as a where Field = 'factortype'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
        </basis>
        <!-- updated login -->
        <basis core="dbsource" name="db" source="trustloginapi" rkey="[##db.get_inputs_rkey.Value##]"
            request="checkrkey">
            <member name="checkrkey" type="view" />
        </basis>
        <basis core="api" name="api.schema" run="AtClient"
            url="https://api.trust-login.com/schema/[##db.get_inputs_rkey.Value##]/en" method="get"
            onprocessed="onProcessedUserinformation"></basis>
        <basis core="external.fly.ws" source="cmsDbService2" name="db" procedurename="dbsource">
            <member name="webservice_detail" method="cms" query='
       { 
           "name": "db",
           "mid": "20",
           "member":
           [
               { 
                   "name": "q", 
                   "type":"list",
                   "request": "webservice_Detail",
                   "id": "[##db.get_inputs_bank_id.Value##]",
                   "dmnid": [##cms.cms.domainid##],
                   "lid":"2"
               }
           ] 
       } ' preview="" />
        </basis>
        <html>

        <head>
            <meta charset="utf-8">
            <meta name="description" content="Waiting" />
            <meta name="author" content="BasisCore">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <link rel="shortcut icon" href="/images/favicon.png" />
            <link rel="shortcut icon" sizes="80x80" href="[##cms.cms.cdn##]/images/shortcut-icon.png" />
            <title>Order</title>
            <style type="text/css">
                <basis core="call" file="Client_Final_Css_en.inc" />
            </style>
            <script type="text/javascript">
                <basis core="call" file="Client_Reservation_js.inc" />
            </script>
        </head>

        <body onload="onloadFunc();">
            <div id="container">
                <div id="Wrapper-resize">
                    <div id="Wrapper">
                        <div class="btn_homepage"><a href="/">Return to the main page of the site</a></div>
                        <div class="btn_document">
                            <a href="[##site.address.domain##]/EN-Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&doc=1"
                                target="_blank">
                                View documents
                                <basis core="group" name="check-type-invoice"
                                    if="'[##db.get_inputs_factortype.Value##]' in ('1','2','7','6')">Flight</basis>
                                <basis core="group" name="check-type-invoice"
                                    if="'[##db.get_inputs_factortype.Value##]' in ('3')">Hotel</basis>
                                <basis core="group" name="check-type-invoice"
                                    if="'[##db.get_inputs_factortype.Value##]' in ('4','10')">Tour</basis>
                                <basis core="group" name="check-type-invoice"
                                    if="'[##db.get_inputs_factortype.Value##]' in ('5')">Insurance</basis>
                                <basis core="group" name="check-type-invoice"
                                    if="'[##db.get_inputs_factortype.Value##]' in ('11')">Lounge</basis>
                                <basis core="group" name="check-type-invoice"
                                    if="'[##db.get_inputs_factortype.Value##]' in ('13')">Visa</basis>
                                <basis core="group" name="check-type-invoice"
                                    if="'[##db.get_inputs_factortype.Value##]' in ('8','9')">Train</basis>
                            </a>
                        </div>
                        <div class="clr"></div>
                        <div class="factor-info counterbox">
                            <div class="text_counter">Remaining time</div>
                            <span id="counter"></span>
                        </div>
                        <div class="clr"></div>
                        <div class="sectionInfo">
                            <div class="loadingLog">
                                <div id="ballsWaveG">
                                    <div id="ballsWaveG_1" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_2" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_3" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_4" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_5" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_6" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_7" class="ballsWaveG"></div>
                                    <div id="ballsWaveG_8" class="ballsWaveG"></div>
                                </div>
                            </div>
                            <div class="txtwating">Contract issuance, please wait...</div>
                        </div>
                        <div class="factor-info">
                            <div class="factor-title"><span>Buyer information :</span></div>
                            <div class="eachInfo user-info-1">
                                <span class="backq">First name:</span>
                                <span class="factor-answer">-</span>
                            </div>
                            <div class="eachInfo user-info-2">
                                <span class="backq">Last name:</span>
                                <span class="factor-answer">-</span>
                            </div>
                            <div class="eachInfo user-info-3">
                                <span class="backq">Email:</span>
                                <span class="factor-answer">-</span>
                            </div>
                            <div class="eachInfo user-info-4">
                                <span class="backq">Tell:</span>
                                <span class="factor-answer">-</span>
                            </div>
                            <div class="eachInfo user-info-5">
                                <span class="backq">Mobile:</span>
                                <span class="factor-answer">-</span>
                            </div>
                            <div class="eachInfo user-info-6">
                                <span class="backq">Address:</span>
                                <span class="factor-answer">-</span>
                            </div>
                            <div class="eachInfo user-info-7">
                                <span class="backq">Gender:</span>
                                <span class="factor-answer">-</span>
                            </div>
                            <div class="eachInfo user-info-8">
                                <span class="backq">Birth date:</span>
                                <span class="factor-answer">-</span>
                            </div>
                            <div class="eachInfo user-info-9">
                                <span class="backq">Postal code:</span>
                                <span class="factor-answer">-</span>
                            </div>
                            <div class="clr"></div>
                        </div>
                        <basis core="group" name="Saman" if="[##db.get_inputs_bank_id.Value##] = 31">
                            <basis core="group" name="samanll">
                                <basis core="external.ws.ws" service="saman" name="saman" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="verifyTransaction" sort="random">
                                        <params>
                                            <param name="RefNum" value="[##cms.form.RefNum##]" />
                                            <param name="MID" value="[##cms.form.MID##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="token" format="json"
                                            postsql="select  value  from [db.token] as a where ParentId = 1" preview="">
                                            {"root":[##saman.m1.result##]}</member>
                                    </basis>
                                    <basis core="group" if="[##db.token.Value##]>0">
                                        <basis core="dbsource" source="accounting" name="db" bankid="1"
                                            invoicenumber="[##cms.form.ResNum##]" cardno="[##cms.form.SecurePan##]"
                                            hashedcardno="[##cms.form.CID##]" merchantid="[##cms.form.MID##]"
                                            paymentid="[##cms.form.RRN##]" refnumber="[##cms.form.TRACENO##]"
                                            status="[##cms.form.StateCode##]" token="[##cms.form.RefNum##]" result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group"
                                        if="[##db.token.Value##] < 0 or '[##db.token.Value##]' = 'null'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="1"
                                            invoicenumber="[##cms.form.ResNum##]" cardno="[##cms.form.SecurePan##]"
                                            hashedcardno="[##cms.form.CID##]" merchantid="[##cms.form.MID##]"
                                            paymentid="[##cms.form.RRN##]" refnumber="[##cms.form.TRACENO##]"
                                            status="[##cms.form.StateCode##]" token="[##cms.form.RefNum##]" result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.token.Value##]' name="token" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##cms.form.ResNum##]" name="ResNum" />
                                        <input type="hidden" value="[##cms.form.SecurePan##]" name="SecurePan" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                style="display:inline-block; direction:ltr">
                                                [##cms.form.SecurePan##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                [##cms.form.TRACENO##] </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##cms.form.StateCode##]'='0'"><span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##cms.form.StateCode##]'='14'"><span
                                                    class="resulF">پرداخت Unsuccessful (Card number نامعتبر است.)</span>
                                            </basis>
                                            <basis core="group" if="'[##cms.form.StateCode##]'='51'"><span
                                                    class="resulF">پرداخت Unsuccessful(موجودي کافی نیست.)</span></basis>
                                            <basis core="group" if="'[##cms.form.StateCode##]'='55'"><span
                                                    class="resulF">پرداخت Unsuccessful(رمز نادرست است)</span></basis>
                                            <basis core="group" if="'[##cms.form.StateCode##]'='38'"><span
                                                    class="resulF">پرداخت Unsuccessful(تعداد دفعات وارد کردن رمز بیش از
                                                    حد
                                                    مجاز است)</span></basis>
                                            <basis core="group" if="'[##cms.form.StateCode##]'='33'"><span
                                                    class="resulF">پرداخت Unsuccessful(تاریخ اعتبار گذشته است و کارت
                                                    نامعتبر است.)</span></basis>
                                            <basis core="group" if="'[##cms.form.StateCode##]'='-1'"><span
                                                    class="resulF">پرداخت Unsuccessful(کاربر از انجام تراکش منصرف شده
                                                    است.)</span></basis>
                                            <basis core="group" if="'[##cms.form.StateCode##]'='96'"><span
                                                    class="resulF">پرداخت Unsuccessful(خطاهای بانکی)</span></basis>
                                        </div>
                                    </div>
                                </basis>
                            </basis>

                            <script type="text/javascript">
                                $.ajax({
                                    type: "POST",
                                    url: "/Client_Final_Payment_en.bc",
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                    }
                                });

                                $(".amount").text(function (index, value) {
                                    return value
                                        .replace(/\D/g, "")
                                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                });
                            </script>


                        </basis>
                        <basis core="group" name="Mellat" if="[##db.get_inputs_bank_id.Value##] = 32">
                            <basis core="inlinesource" name="db">
                                <member name="terminalid" format="json"
                                    postsql="select value from [db.terminalid] where field = 'terminalid'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="username" format="json"
                                    postsql="select value from [db.username] where field = 'username'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="password" format="json"
                                    postsql="select value from [db.password] where field = 'password'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="Mellatall">
                                <basis core="external.ws.ws" service="mellat" name="mellat" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="bpVerifyRequest" sort="random">
                                        <params>
                                            <param name="TerminalId" value="[##db.terminalid.Value##]" />
                                            <param name="userName" value="[##db.username.Value##]" />
                                            <param name="userPassword" value="[##db.password.Value##]" />
                                            <param name="orderId" value="[##cms.form.SaleOrderId##]" />
                                            <param name="saleOrderId" value="[##cms.form.SaleOrderId##]" />
                                            <param name="saleReferenceId" value="[##cms.form.SaleReferenceId##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="MellatallDelay">
                                    <basis core="external.ws.ws" service="mellat" name="mellat2" source="cmsDbService"
                                        procedurename="sbserviceprocedure1" preview="">
                                        <member name="m2" method="bpSettleRequest" sort="random">
                                            <params>
                                                <param name="TerminalId" value="[##db.terminalid.Value##]" />
                                                <param name="userName" value="[##db.username.Value##]" />
                                                <param name="userPassword" value="[##db.password.Value##]" />
                                                <param name="orderId" value="[##cms.form.SaleOrderId##]" />
                                                <param name="saleOrderId" value="[##cms.form.SaleOrderId##]" />
                                                <param name="saleReferenceId" value="[##cms.form.SaleReferenceId##]" />
                                            </params>
                                        </member>
                                    </basis>
                                    <basis core="group" name="json">
                                        <basis core="inlinesource" name="db">
                                            <member name="token" format="json"
                                                postsql="select  value  from [db.token] as a where ParentId = 1"
                                                preview="">
                                                {"root":[##mellat.m1.result##]}
                                            </member>
                                        </basis>
                                        <basis core="group" if="'[##db.token.Value##]' = '0'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="2" invoicenumber="[##cms.form.SaleOrderId##]"
                                                cardno="[##cms.form.CardHolderPan##]"
                                                hashedcardno="[##cms.form.CardHolderInfo##]" merchantid="" paymentid=""
                                                refnumber="[##cms.form.SaleReferenceId##]"
                                                status="[##cms.form.ResCode##]" token="[##cms.form.RefId##]" result="1">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <basis core="group" if="'[##db.token.Value##]' <> '0'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="2" invoicenumber="[##cms.form.SaleOrderId##]"
                                                cardno="[##cms.form.CardHolderPan##]"
                                                hashedcardno="[##cms.form.CardHolderInfo##]" merchantid="" paymentid=""
                                                refnumber="[##cms.form.SaleReferenceId##]"
                                                status="[##cms.form.ResCode##]" token="[##cms.form.RefId##]" result="0">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                            class="formbank">
                                            <input type="hidden" value='[##db.token.Value##]' name="token" />
                                            <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                            <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                            <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                                name="factorid" />
                                            <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                                name="agencyid" />
                                            <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                                name="supplier" />
                                            <input type="hidden" value="[##db.get_inputs_paytype.Value##]"
                                                name="paytype" />
                                            <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                                name="trackingid" />
                                            <input type="hidden" value="[##db.get_inputs_bank_id.Value##]"
                                                name="bank_id" />
                                            <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                                name="factortype" />
                                            <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                                name="paymentid" />
                                        </form>
                                        <div class="factor-info">
                                            <div class="factor-title"><span>Summary of transaction status :</span></div>
                                            <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                    style="display:inline-block; direction:ltr;">
                                                    [##cms.form.CardHolderPan##]</span></div>
                                            <div class="eachInfo"><span class="backq">Transaction amount : </span>
                                                <span>
                                                    <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                    [##db.unit_title.Value##] </span>
                                            </div>
                                            <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                    [##cms.form.SaleReferenceId##] </span></div>
                                            <div class="eachInfo"><span class="backq">Transaction status : </span>
                                                <basis core="group" if="'[##cms.form.ResCode##]'='0'"> <span
                                                        class="resultT" id="resulTimeout">Successful</span></basis>
                                                <basis core="group" if="'[##cms.form.ResCode##]'='11'"> <span
                                                        class="resulF">Failed (card number is invalid.)</span></basis>
                                                <basis core="group" if="'[##cms.form.ResCode##]'='12'"> <span
                                                        class="resulF">Failed (inventory is not enough.)</span></basis>
                                                <basis core="group" if="'[##cms.form.ResCode##]'='13'"> <span
                                                        class="resulF">Failed (incorrect password)</span></basis>
                                                <basis core="group" if="'[##cms.form.ResCode##]'='14'"> <span
                                                        class="resulF">Failed (too many passwords allowed)</span>
                                                </basis>
                                                <basis core="group" if="'[##cms.form.ResCode##]'='15'"> <span
                                                        class="resulF">Failed (card is invalid.)</span></basis>
                                                <basis core="group" if="'[##cms.form.ResCode##]'='16'"> <span
                                                        class="resulF">Unsuccessful (Excessive withdrawals are
                                                        allowed.)</span></basis>
                                                <basis core="group" if="'[##cms.form.ResCode##]'='17'"> <span
                                                        class="resulF">Unsuccessful (user has stopped tracing.)</span>
                                                </basis>
                                                <basis core="group" if="'[##cms.form.ResCode##]'='18'"> <span
                                                        class="resulF">Failed (card expires on expiration date.)</span>
                                                </basis>
                                                <basis core="group" if="'[##cms.form.ResCode##]'='19'"> <span
                                                        class="resulF">Unsuccessful (overdraft is allowed.)</span>
                                                </basis>
                                                <basis core="group" if="'[##cms.form.ResCode##]'='51'"> <span
                                                        class="resulF">Failed (transaction is duplicate)</span></basis>
                                                <basis core="group"
                                                    if="[##cms.form.ResCode##] not in (0,11,12,13,14,15,16,17,18,19,51)">
                                                    <span class="resulF">Unsuccessful</span>
                                                </basis>
                                            </div>
                                        </div>
                                    </basis>
                                </basis>
                            </basis>

                            <script type="text/javascript">
                                $.ajax({
                                    type: "POST",
                                    url: "/Client_Final_Payment_en.bc",
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                    }
                                });
                                $(".amount").text(function (index, value) {
                                    return value
                                        .replace(/\D/g, "")
                                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                });
                            </script>


                        </basis>
                        <basis core="group" name="Psargad" if="[##db.get_inputs_bank_id.Value##] = 33">
                            <basis core="inlinesource" name="db">
                                <member name="merchantID" format="json"
                                    postsql="select value from [db.merchantID] where field = 'merchantid'" preview="">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="terminalID" format="json"
                                    postsql="select value from [db.terminalID] where field = 'terminalid'" preview="">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="Vdelay">
                                <basis core="external.ws.ws" service="pasargadBank" name="pasargad"
                                    source="cmsDbService" procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="pasargadCheckTransaction"
                                        merchantCode="[##db.merchantID.Value##]" sort="random">
                                        <params>
                                            <param name="tref" value="[##cms.query.tref##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="delay">
                                    <basis core="inlinesource" name="db">
                                        <member name="Form-Tree" format="json" preview="">
                                            {"root":[##pasargad.m1.result##]}</member>
                                        <member name="ReferenceID" format="json"
                                            postsql="select value from [db.ReferenceID] where field = 'transactionReferenceID'"
                                            preview="">{"root":[##pasargad.m1.result##]}</member>
                                        <member name="traceNumber" format="json"
                                            postsql="select value from [db.traceNumber] where field = 'traceNumber'"
                                            preview="">
                                            {"root":[##pasargad.m1.result##]}</member>
                                        <member name="invoiceNumber" format="json"
                                            postsql="select value from [db.invoiceNumber] where field = 'invoiceNumber'"
                                            preview="">{"root":[##pasargad.m1.result##]}</member>
                                        <member name="invoiceDate" format="json"
                                            postsql="select value from [db.invoiceDate] where field = 'invoiceDate'"
                                            preview="">
                                            {"root":[##pasargad.m1.result##]}</member>
                                        <member name="amount" format="json"
                                            postsql="select value from [db.amount] where field = 'amount'" preview="">
                                            {"root":[##pasargad.m1.result##]}</member>
                                    </basis>
                                    <basis core="group" name="">
                                        <basis core="external.ws.ws" service="pasargadBank" name="pasargad"
                                            source="cmsDbService" procedurename="sbserviceprocedure1" preview="">
                                            <member name="m2" method="pasargadVerifyPayment"
                                                merchantCode="[##db.merchantID.Value##]" sort="random">
                                                <params>
                                                    <param name="merchantCode" value="[##db.merchantID.Value##]" />
                                                    <param name="terminalCode" value="[##db.terminalID.Value##]" />
                                                    <param name="invoiceNumber" value="[##db.invoiceNumber.Value##]" />
                                                    <param name="invoiceDate" value="[##db.invoiceDate.Value##]" />
                                                    <param name="amount" value="[##db.amount.Value##]" />
                                                </params>
                                            </member>
                                        </basis>
                                        <basis core="group" name="delay">
                                            <basis core="inlinesource" name="db">
                                                <member name="verifypay" format="json"
                                                    postsql="select  Value from [db.verifypay] as a where Field is 'result'"
                                                    preview="">{"root":[##pasargad.m2.result##]}</member>
                                            </basis>
                                            <basis core="group" if="'[##db.verifypay.Value##]' <> 'True'">
                                                <basis core="dbsource" source="accounting" name="db" bankid="3"
                                                    invoicenumber="[##db.invoiceNumber.Value##]" cardno=""
                                                    hashedcardno="" merchantid="[##db.merchantID.Value##]" paymentid=""
                                                    refnumber="[##db.traceNumber.Value##]" status="0"
                                                    token="[##db.ReferenceID.Value##]" result="0">
                                                    <member name="updatepayment" type="scalar" request="updatepayment"
                                                        preview="" />
                                                </basis>
                                                <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                            </basis>
                                            <basis core="group" if="'[##db.verifypay.Value##]' = 'True'">
                                                <basis core="dbsource" source="accounting" name="db" bankid="3"
                                                    invoicenumber="[##db.invoiceNumber.Value##]" cardno=""
                                                    hashedcardno="" merchantid="[##db.merchantID.Value##]" paymentid=""
                                                    refnumber="[##db.traceNumber.Value##]" status="1"
                                                    token="[##db.ReferenceID.Value##]" result="1">
                                                    <member name="updatepayment" type="scalar" request="updatepayment"
                                                        preview="" />
                                                </basis>
                                                <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                            </basis>
                                            <form method="post" action="/Client_Final_Payment_en.bc" name="verify"
                                                class="verify formbank">
                                                <input type="hidden" value="[##db.verifypay.Value|(0)##]"
                                                    name="verifypay" />
                                                <input type="hidden" value="[##db.checkrkey.userid|(0)##]"
                                                    name="userid" />
                                                <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                                    name="agencyid" />
                                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                                    name="supplier" />
                                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]"
                                                    name="paytype" />
                                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                                    name="factorid" />
                                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                                    name="trackingid" />
                                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]"
                                                    name="bank_id" />
                                                <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                                    name="factortype" />
                                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                                    name="paymentid" />
                                            </form>
                                            <div class="factor-info">
                                                <div class="factor-title"><span>Summary of transaction status :</span>
                                                </div>
                                                <div class="eachInfo"><span class="backq">Transaction amount : </span>
                                                    <span> <span
                                                            class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                        [##db.unit_title.Value##]</span>
                                                </div>
                                                <basis core="print" datamembername="db.Form-Tree">
                                                    <layout>
                                                        <div class="eachInfo"><span class="backq">Issue Tracking :
                                                            </span>@child</div>
                                                    </layout>
                                                    <face filter="Field = 'traceNumber'">
                                                        <span>@value </span>
                                                    </face>
                                                </basis>
                                                <basis core="print" datamembername="db.Form-Tree">
                                                    <layout>
                                                        <div class="eachInfo"><span class="backq">Transaction status :
                                                            </span>@child</div>
                                                    </layout>
                                                    <face filter="Field = 'result'">
                                                        <span>@value </span>
                                                    </face>
                                                </basis>
                                                <basis core="print" datamembername="db.Form-Tree">
                                                    <layout>
                                                        <div class="eachInfo"><span class="backq">Transaction time :
                                                            </span>@child</div>
                                                    </layout>
                                                    <face filter="Field = 'invoiceDate'">
                                                        <span>@value </span>
                                                    </face>
                                                </basis>
                                                <div class="clr"></div>
                                            </div>
                                        </basis>
                                    </basis>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>

                            </basis>
                        </basis>
                        <basis core="group" name="Pay" if="[##db.get_inputs_bank_id.Value##] = 34">
                            <basis core="inlinesource" name="db">
                                <member name="api" format="json"
                                    postsql="select value from [db.api] where field = 'api'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="Pay">
                                <basis core="external.ws.ws" service="pay" name="pay" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="verify" sort="random">
                                        <params>
                                            <param name="api" value="[##db.api.Value##]" />
                                            <param name="token" value="[##cms.query.token##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="DelayPay">
                                    <basis core="inlinesource" name="db">
                                        <member name="status" format="json"
                                            postsql="select  Value  from [db.status] where field = 'status'" preview="">
                                            {"root":[##pay.m1.result##]}</member>
                                        <member name="amount" format="json"
                                            postsql="select  Value  from [db.amount] where field = 'amount'" preview="">
                                            {"root":[##pay.m1.result##]}</member>
                                        <member name="transId" format="json"
                                            postsql="select  Value  from [db.transId] where field = 'transId'"
                                            preview="">
                                            {"root":[##pay.m1.result##]}</member>
                                        <member name="cardNumber" format="json"
                                            postsql="select  Value  from [db.cardNumber] where field = 'cardNumber'"
                                            preview="">
                                            {"root":[##pay.m1.result##]}</member>
                                        <member name="factorNumber" format="json"
                                            postsql="select  Value  from [db.factorNumber] where field = 'factorNumber'"
                                            preview="">{"root":[##pay.m1.result##]}</member>
                                    </basis>
                                    <basis core="group" name="DelayPay2">


                                        <basis core="group" if="'[##db.status.Value##]' = 'true' ">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="10" invoicenumber="[##db.factorNumber.Value##]"
                                                cardno="[##db.cardNumber.Value##]" hashedcardno="" merchantid=""
                                                paymentid="" refnumber="[##db.transId.Value##]"
                                                status="[##cms.query.status##]" token="[##cms.query.token##]"
                                                result="1">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <basis core="group" if="'[##db.status.Value##]' <> 'true' ">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="10" invoicenumber="[##db.factorNumber.Value##]"
                                                cardno="[##db.cardNumber.Value##]" hashedcardno="]" merchantid=""
                                                paymentid="" refnumber="[##db.transId.Value##]"
                                                status="[##cms.query.status##]" token="[##cms.query.token##]"
                                                result="0">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                            class="formbank">
                                            <input type="hidden" value='[##db.status.Value##]' name="status" />
                                            <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                            <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                            <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                                name="factorid" />
                                            <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                                name="agencyid" />
                                            <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                                name="supplier" />
                                            <input type="hidden" value="[##db.get_inputs_paytype.Value##]"
                                                name="paytype" />
                                            <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                                name="trackingid" />
                                            <input type="hidden" value="[##db.get_inputs_bank_id.Value##]"
                                                name="bank_id" />
                                            <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                                name="factortype" />
                                            <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                                name="paymentid" />
                                        </form>
                                        <div class="factor-info">
                                            <div class="factor-title"><span>Summary of transaction status :</span></div>
                                            <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                    style="display:inline-block; direction:ltr;">[##db.cardNumber.Value##]</span>
                                            </div>
                                            <div class="eachInfo"><span class="backq">Transaction amount : </span>
                                                <span>
                                                    <span class="amount">[##db.amount.Value##]</span>
                                                    [##db.unit_title.Value##]</span>
                                            </div>
                                            <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                    [##db.transId.Value##] </span></div>
                                            <div class="eachInfo"><span class="backq">Transaction status : </span>
                                                <basis core="group" if="'[##db.status.Value##]'='true'"> <span
                                                        class="resultT" id="resulTimeout">Successful</span></basis>
                                                <basis core="group" if="'[##db.status.Value##]'='false'"> <span
                                                        class="resulF">Unsuccessful</span></basis>
                                                <basis core="group" if="'[##db.status.Value##]'='false'">
                                                    <basis core="inlinesource" name="db">
                                                        <member name="errorMessage" format="json"
                                                            postsql="select  Value  from [db.errorMessage] where field = 'errorMessage'"
                                                            preview="">{"root":[##pay.m1.result##]}</member>
                                                    </basis>
                                                    <span class="resulF">[##db.errorMessage.Value##]</span>
                                                </basis>
                                            </div>
                                        </div>

                                    </basis>
                                </basis>
                            </basis>

                            <script type="text/javascript">
                                $.ajax({
                                    type: "POST",
                                    url: "/Client_Final_Payment_en.bc",
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                    }
                                });
                                $(".amount").text(function (index, value) {
                                    return value
                                        .replace(/\D/g, "")
                                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                });
                            </script>


                        </basis>
                        <basis core="group" name="zarrinpal" if="[##db.get_inputs_bank_id.Value##] = 35">
                            <basis core="inlinesource" name="db">
                                <member name="merchantID" format="json" preview=""
                                    postsql="select value from [db.merchantID] where field = 'merchantid'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="json">
                                <basis core="external.ws.ws" service="zarrinPal" name="zarrinPal_verify"
                                    source="cmsDbService" procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="PaymentVerification" sort="random" preview="">
                                        <params>
                                            <param name="MerchantID" value="[##db.merchantID.Value##]" />
                                            <param name="Authority" value="[##cms.query.Authority##]" />
                                            <param name="Amount" value="[##db.get_inputs_totalfinal.Value##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="Status" format="json"
                                            postsql="select  value  from [db.Status] as a where field = 'Status'"
                                            preview="">
                                            {"root":[##zarrinPal_verify.m1.result##]}</member>
                                        <member name="RefID" format="json"
                                            postsql="select  value  from [db.RefID] as a where field = 'RefID'"
                                            preview="">
                                            {"root":[##zarrinPal_verify.m1.result##]}</member>
                                    </basis>
                                    <basis core="group" if="'[##db.Status.Value##]'= '100'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="11"
                                            invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid="" paymentid="" refnumber="[##db.RefID.Value##]"
                                            status="[##db.Status.Value##]" token="" result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group" if="'[##db.Status.Value##]' <> '100'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="11"
                                            invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid="" paymentid="" refnumber="[##db.RefID.Value##]"
                                            status="[##db.Status.Value##]" token="" result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.Status.Value##]' name="token" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                        <input type="hidden" value="[##db.get_inputs_totalfinal.Value##]"
                                            name="amount" />

                                        <!-- updated login -->
                                        <input type="hidden" value="" name="firstName" class="user-info-1" />
                                        <input type="hidden" value="" name="lastName" class="user-info-2" />
                                        <input type="hidden" value="" name="mobile" class="user-info-5" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                [##db.RefID.Value##] </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.Status.Value##]'='100'"><span class="resultT"
                                                    id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.Status.Value##]'='-51'"><span
                                                    class="resulF">Failed payment (user cancels transaction)</span>
                                            </basis>
                                            <basis core="group" if="'[##db.Status.Value##]'not in ('100','-51')">
                                                <span class="resulF">Unsuccessful</span>
                                            </basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>


                            </basis>
                        </basis>
                        <basis core="group" name="Asanpardakht" if="[##db.get_inputs_bank_id.Value##] = 38">
                            <basis core="inlinesource" name="db">
                                <member name="merchantID" format="json"
                                    postsql="select value from [db.merchantID] where field = 'merchantid'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="username" format="json"
                                    postsql="select value from [db.username] where field = 'username'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="password" format="json"
                                    postsql="select value from [db.password] where field = 'password'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="easypay">
                                <basis core="external.ws.ws" service="easyPayment" name="asanPardakht"
                                    source="cmsDbService" procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="DecryptData" sort="random" preview="">
                                        <params>
                                            <param name="SSLid" value="13" />
                                            <param name="ReturningParams" value="[##cms.form.ReturningParams##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="vrf1">
                                    <basis core="inlinesource" name="db">
                                        <member name="PayGateTranID" format="json" preview=""
                                            postsql="select Value from [db.PayGateTranID] where Field = 'PayGateTranID'">
                                            {"root":[##asanPardakht.m1.result##]} </member>
                                        <member name="Form-Tree" format="json"> {"root":[##asanPardakht.m1.result##]}
                                        </member>
                                    </basis>
                                    <basis core="group" name="vrf2">
                                        <basis core="external.ws.ws" service="easyPayment" name="asanPardakht"
                                            source="cmsDbService" procedurename="sbserviceprocedure1" preview="">
                                            <member name="verify1" method="RequestVerification" sort="random"
                                                preview="">
                                                <params>
                                                    <param name="SSLid" value="13" />
                                                    <param name="merchantConfigurationID"
                                                        value="[##db.merchantID.Value##]" />
                                                    <param name="payGateTranID " value="[##db.PayGateTranID.Value##]" />
                                                    <param name="userName" value="[##db.username.Value##]" />
                                                    <param name="password" value="[##db.password.Value##]" />
                                                </params>
                                            </member>
                                        </basis>
                                        <basis core="group" name="vrf3">
                                            <basis core="inlinesource" name="db">
                                                <member name="verify1-Tree" format="json" preview=""
                                                    postsql="select Value from [db.verify1-Tree] where Field = 'asanPardakht_verify1'">
                                                    {"root":[##asanPardakht.verify1.result##]}
                                                </member>
                                            </basis>
                                            <basis core="group" if="'[##db.verify1-Tree.Value##]' = '500'">
                                                <basis core="external.ws.ws" service="easyPayment" name="asanPardakht"
                                                    source="cmsDbService" procedurename="sbserviceprocedure1"
                                                    preview="">
                                                    <member name="verify2" method="RequestReconciliation" sort="random"
                                                        preview="">
                                                        <params>
                                                            <param name="SSLid" value="13" />
                                                            <param name="merchantConfigurationID"
                                                                value="[##db.merchantID.Value##]" />
                                                            <param name="payGateTranID "
                                                                value="[##db.PayGateTranID.Value##]" />
                                                            <param name="userName" value="[##db.username.Value##]" />
                                                            <param name="password" value="[##db.password.Value##]" />
                                                        </params>
                                                    </member>
                                                </basis>
                                                <basis core="group" name="vrf4">
                                                    <basis core="inlinesource" name="db">
                                                        <member name="verify2-Tree" format="json" preview=""
                                                            postsql="select Value from [db.verify2-Tree] where Field = 'asanPardakht_verify2'">
                                                            {"root":[##asanPardakht.verify2.result##]}
                                                        </member>
                                                    </basis>
                                                    <basis core="group" name="json">
                                                        <basis core="inlinesource" name="db">
                                                            <member name="FirstSixDigitOfPAN" format="json"
                                                                postsql="select value from [db.FirstSixDigitOfPAN] where field = 'FirstSixDigitOfPAN'">
                                                                {"root":[##db.Form-Tree.result##]} </member>
                                                            <member name="LastFourDigitOfPAN" format="json"
                                                                postsql="select value from [db.LastFourDigitOfPAN] where field = 'LastFourDigitOfPAN'">
                                                                {"root":[##db.Form-Tree.result##]} </member>
                                                            <member name="RRN" format="json"
                                                                postsql="select value from [db.RRN] where field = 'RRN'">
                                                                {"root":[##db.Form-Tree.result##]} </member>
                                                            <member name="PayGateTranID" format="json"
                                                                postsql="select value from [db.PayGateTranID] where field = 'PayGateTranID'">
                                                                {"root":[##db.Form-Tree.result##]} </member>
                                                            <member name="ResCode" format="json"
                                                                postsql="select value from [db.ResCode] where field = 'ResCode'">
                                                                {"root":[##db.Form-Tree.result##]} </member>
                                                            <member name="RefID" format="json"
                                                                postsql="select value from [db.RefID] where field = 'RefID'">
                                                                {"root":[##db.Form-Tree.result##]} </member>
                                                        </basis>
                                                        <basis core="group" if="'[##db.verify2-Tree.Value##]' = '600'">
                                                            <basis core="dbsource" source="accounting" name="db"
                                                                bankid="8"
                                                                invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                                cardno="[##db.FirstSixDigitOfPAN.Value##]"
                                                                hashedcardno="[##db.LastFourDigitOfPAN.Value##]"
                                                                merchantid="[##db.merchantID.Value##]"
                                                                paymentid="[##db.RRN.Value##]"
                                                                refnumber="[##db.PayGateTranID.Value##]"
                                                                status="[##db.ResCode.Value##]"
                                                                token="[##db.RefID.Value##]" result="1">
                                                                <member name="updatepayment" type="scalar"
                                                                    request="updatepayment" preview="" />
                                                            </basis>
                                                            <div class="updatepaymentT"> [##db.updatepayment.title##]
                                                            </div>
                                                        </basis>
                                                        <basis core="group" if="'[##db.verify2-Tree.Value##]' <> '600'">
                                                            <basis core="dbsource" source="accounting" name="db"
                                                                bankid="8"
                                                                invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                                cardno="[##db.FirstSixDigitOfPAN.Value##]"
                                                                hashedcardno="[##db.LastFourDigitOfPAN.Value##]"
                                                                merchantid="[##db.merchantID.Value##]"
                                                                paymentid="[##db.RRN.Value##]"
                                                                refnumber="[##db.PayGateTranID.Value##]"
                                                                status="[##db.ResCode.Value##]"
                                                                token="[##db.RefID.Value##]" result="0">
                                                                <member name="updatepayment" type="scalar"
                                                                    request="updatepayment" preview="" />
                                                            </basis>
                                                            <div class="updatepaymentF"> [##db.updatepayment.title##]
                                                            </div>
                                                        </basis>
                                                        <form method="post" action="/Client_Final_Payment_en.bc"
                                                            name="formbank" class="formbank">
                                                            <input type="hidden" value="[##db.checkrkey.userid|(0)##]"
                                                                name="userid" />
                                                            <input type="hidden" value="[##cms.cms.domainid##]"
                                                                name="dmnid" />
                                                            <input type="hidden"
                                                                value="[##db.get_inputs_paymentid.Value##]"
                                                                name="paymentid" />
                                                            <input type="hidden"
                                                                value="[##db.get_inputs_factorid.Value##]"
                                                                name="factorid" />
                                                            <input type="hidden"
                                                                value="[##db.get_inputs_agencyid.Value##]"
                                                                name="agencyid" />
                                                            <input type="hidden"
                                                                value="[##db.get_inputs_supplier.Value##]"
                                                                name="supplier" />
                                                            <input type="hidden"
                                                                value="[##db.get_inputs_paytype.Value##]"
                                                                name="paytype" />
                                                            <input type="hidden"
                                                                value="[##db.get_inputs_trackingid.Value##]"
                                                                name="trackingid" />
                                                            <input type="hidden"
                                                                value="[##db.get_inputs_bank_id.Value##]"
                                                                name="bank_id" />
                                                            <input type="hidden" value="[##db.verify2-Tree.Value##]"
                                                                name="token" />
                                                            <input type="hidden"
                                                                value="[##db.get_inputs_factortype.Value##]"
                                                                name="factortype" />
                                                        </form>

                                                        <div class="factor-info">
                                                            <div class="factor-title"><span>Summary of transaction
                                                                    status
                                                                    :</span></div>
                                                            <basis core="print" datamembername="db.Form-Tree">
                                                                <layout>
                                                                    <div class="eachInfo"><span class="backq">Card
                                                                            number : </span><span>@child</span></div>
                                                                </layout>
                                                                <face filter="Field = 'FirstSixDigitOfPAN'">
                                                                    <span> @value</span>
                                                                </face>
                                                                <face filter="Field = 'LastFourDigitOfPAN'">
                                                                    <span> ****** @value</span>
                                                                </face>
                                                            </basis>
                                                            <basis core="print" datamembername="db.Form-Tree">
                                                                <layout>
                                                                    <div class="eachInfo"><span
                                                                            class="backq">Transaction amount :
                                                                        </span>@child <span> [##db.unit_title.Value##]
                                                                        </span></div>
                                                                </layout>
                                                                <face filter="Field = 'Amount'">
                                                                    <span class="amount">@value</span>
                                                                </face>
                                                            </basis>
                                                            <basis core="print" datamembername="db.Form-Tree">
                                                                <layout>
                                                                    <div class="eachInfo"><span class="backq">Issue
                                                                            Tracking : </span>@child</div>
                                                                </layout>
                                                                <face filter="Field = 'PayGateTranID'">
                                                                    <span>@value </span>
                                                                </face>
                                                            </basis>
                                                            <basis core="print" datamembername="db.Form-Tree">
                                                                <layout>
                                                                    <div class="callback"><span
                                                                            class="backq">Transaction status:
                                                                        </span>@child</div>
                                                                </layout>
                                                                <face
                                                                    filter="Field = 'ResCode' and value in ('00','0')">
                                                                    <span>Successful</span>
                                                                </face>
                                                                <face
                                                                    filter="Field = 'ResCode' and value not in ('00','0')">
                                                                    <span>Unsuccessful</span>
                                                                </face>
                                                            </basis>
                                                        </div>
                                                    </basis>
                                                </basis>
                                            </basis>
                                            <basis core="group" if="'[##db.verify1-Tree.Value##]' <> '500'">
                                                <div class="alert-Txt">Payment failed</div>
                                                <div class="alert-Txt">...Loading information please wait</div>
                                            </basis>
                                        </basis>
                                    </basis>
                                </basis>
                            </basis>


                            <script type="text/javascript">
                                $.ajax({
                                    type: "POST",
                                    url: "/Client_Final_Payment_en.bc",
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                    }
                                });
                                $(".amount").text(function (index, value) {
                                    return value
                                        .replace(/\D/g, "")
                                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                });
                            </script>


                        </basis>
                        <basis core="group" name="Sekhavat" if="[##db.get_inputs_bank_id.Value##] = 39">
                            <basis core="group" name="sekhavatll">
                                <basis core="external.ws.ws" service="sekhavat" name="sekhavat" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="sale" sort="random">
                                        <params>
                                            <param name="SSLid" value="12" />
                                            <param name="vendorId" value="PSekhTick2016" />
                                            <param name="vendorPass" value="O5rt8Eku7" />
                                            <param name="TerminalId" value="bmi035" />
                                            <param name="TerminalPass" value="9725" />
                                            <param name="merchantId" value="27035" />
                                            <param name="merchantReference" value="[##cms.form.merchantReference##]" />
                                            <param name="merchantDate" value="[##cms.form.merchantDate##]" />
                                            <param name="merchantTime" value="[##cms.form.merchantTime##]" />
                                            <param name="cardNum" value="[##cms.form.cardNum##]" />
                                            <param name="cardType" value="[##cms.form.cardType##]" />
                                            <param name="securityCode" value="[##cms.form.securityCode##]" />
                                            <param name="expYear" value="[##cms.form.expYear##]" />
                                            <param name="expMonth" value="[##cms.form.expMonth##]" />
                                            <param name="cardHolderIp" value="[##cms.form.cardHolderIp##]" />
                                            <param name="dutyAmount" value="[##cms.form.dutyAmount##]" />
                                            <param name="shippingAmount" value="[##cms.form.shippingAmount##]" />
                                            <param name="taxAmount" value="[##cms.form.taxAmount##]" />
                                            <param name="purchaseAmount" value="[##cms.form.purchaseAmount##]" />
                                            <param name="totalAmount" value="[##cms.form.totalAmount##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="token" format="json"
                                            postsql="select  value  from [db.token] as a where Field = 'Status'"
                                            preview="">
                                            {"root":[##sekhavat.m1.result##]}</member>
                                        <member name="token2" format="json"
                                            postsql="select  value  from [db.token2] as a where Field = 'Approval_code'"
                                            preview="">{"root":[##sekhavat.m1.result##]}</member>
                                    </basis>
                                    <basis core="group" if="'[##db.token.Value##]' = 'ok'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="9"
                                            invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                            cardno="[##cms.form.cardNum1##]" hashedcardno="[##cms.form.cardNum2##]"
                                            merchantid="27035" paymentid="[##db.token2.Value##]" refnumber="" status="1"
                                            token="" result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group" if="'[##db.token.Value##]' <> 'ok'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="9"
                                            invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                            cardno="[##cms.form.cardNum1##]" hashedcardno="[##cms.form.cardNum2##]"
                                            merchantid="27035" paymentid="[##db.token2.Value##]" refnumber="" status="0"
                                            token="" result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.token.Value##]' name="token" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##cms.form.merchantReference##]"
                                            name="merchantReference" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />

                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                class="card-number" style="display:inline-block; direction:ltr;">
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" name="g1">
                                                <basis core="inlinesource" name="db1">
                                                    <member name="mskh" format="json"
                                                        postsql="select  value  from [db1.mskh] as a where Field = 'Status'"
                                                        preview="">{"root":[##sekhavat.m1.result##]}</member>
                                                </basis>
                                                <basis core="group" if="'[##db1.mskh.Value##]'='ok'"><span
                                                        class="resultT" id="resulTimeout">Successful</span></basis>
                                                <basis core="group" if="'[##db1.mskh.Value##]'='error'"> <span
                                                        class="resulF">Unsuccessful</span></basis>
                                            </basis>
                                        </div>
                                    </div>
                                </basis>
                            </basis>


                            <script type="text/javascript">
                                $.ajax({
                                    type: "POST",
                                    url: "/Client_Final_Payment_en.bc",
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                    }
                                });
                                $(".amount").text(function (index, value) {
                                    return value
                                        .replace(/\D/g, "")
                                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                });
                            </script>


                        </basis>
                        <basis core="group" name="Gardeshgari" if="[##db.get_inputs_bank_id.Value##] = 50">
                            <basis core="external.ws.ws" service="gardeshPay" name="gardeshPay" source="cmsDbService"
                                procedurename="sbserviceprocedure1" preview="">
                                <member name="m1" method="verify" sort="random" preview="">
                                    <params>
                                        <param name="trackingNumber" value="[##cms.query.trackingNumber##]" />
                                    </params>
                                </member>
                            </basis>
                            <basis core="group" name="json">
                                <basis core="inlinesource" name="db">
                                    <member name="answer" format="json"
                                        postsql="select value from [db.answer] where field = 'answer'" preview="">
                                        {"root":[##gardeshPay.m1.result##]}
                                    </member>
                                    <member name="token" format="json"
                                        postsql="select value from [db.token] where field = 'success'" preview="">
                                        {"root":[##db.answer.Value##]}
                                    </member>
                                    <member name="data" format="json"
                                        postsql="select value from [db.data] where field = 'data'" preview="">
                                        {"root":[##db.answer.Value##]}
                                    </member>
                                    <member name="cardNumber" format="json"
                                        postsql="select value from [db.cardNumber] where field = 'cardNumber'"
                                        preview="">
                                        {"root":[##db.answer.Value##]}
                                    </member>
                                    <member name="hashedCardNumber" format="json"
                                        postsql="select value from [db.hashedCardNumber] where field = 'hashedCardNumber'"
                                        preview="">
                                        {"root":[##db.answer.Value##]}
                                    </member>
                                    <member name="refNumber" format="json"
                                        postsql="select value from [db.refNumber] where field = 'refNumber'" preview="">
                                        {"root":[##db.answer.Value##]}
                                    </member>
                                </basis>
                                <basis core="group" if="'[##db.token.Value##]' = 'true'">
                                    <basis core="dbsource" source="accounting" name="db" mid="43" lid="1" bankid="12"
                                        invoicenumber="[##cms.query.invoiceNumber##]" cardno="[##db.cardNumber.Value##]"
                                        hashedcardno="[##db.hashedCardNumber.Value##]" merchantid="" paymentid=""
                                        refnumber="[##db.refNumber.Value##]" status="1" token="" result="1">
                                        <member name="updatepayment" type="scalar" request="updatepayment" preview="" />
                                    </basis>
                                    <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                </basis>
                                <basis core="group" if="'[##db.token.Value##]' <> 'true'">
                                    <basis core="dbsource" source="accounting" name="db" mid="43" lid="1" bankid="12"
                                        invoicenumber="[##cms.query.invoiceNumber##]" cardno="" hashedcardno=""
                                        merchantid="" paymentid="" refnumber="" status="0" token="" result="0">
                                        <member name="updatepayment" type="scalar" request="updatepayment" preview="" />
                                    </basis>
                                    <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                </basis>
                                <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                    class="formbank">
                                    <input type="hidden" value='[##db.token.Value##]' name="token" />
                                    <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                    <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                    <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                    <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                    <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                    <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                    <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                        name="trackingid" />
                                    <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                    <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                        name="factortype" />
                                    <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                </form>
                                <div class="factor-info">
                                    <div class="factor-title"><span>Summary of transaction status :</span></div>
                                    <div class="eachInfo"><span class="backq">Card number : </span> <span
                                            style="display:inline-block; direction:ltr;">
                                            [##db.cardNumber.Value##]</span></div>
                                    <div class="eachInfo"><span class="backq">Transaction amount : </span> <span> <span
                                                class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                            [##db.unit_title.Value##]
                                        </span></div>
                                    <div class="eachInfo"><span class="backq">Transaction status : </span>
                                        <basis core="group" if="'[##db.token.Value##]'='true'"> <span class="resultT"
                                                id="resulTimeout">Successful</span></basis>
                                        <basis core="group" if="'[##db.token.Value##]'<>'true'"> <span
                                                class="resulF">Unsuccessful</span></basis>
                                    </div>
                                </div>
                            </basis>
                            <script type="text/javascript">
                                $.ajax({
                                    type: "POST",
                                    url: "/Client_Final_Payment_en.bc",
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                    }
                                });
                                $(".amount").text(function (index, value) {
                                    return value
                                        .replace(/\D/g, "")
                                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                });
                            </script>
                        </basis>
                        <basis core="group" name="kipaa" if="[##db.get_inputs_bank_id.Value##] = 51">
                            <basis core="inlinesource" name="db">
                                <member name="token" format="json"
                                    postsql="select value from [db.token] where field = 'token'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="kipaaPayment">
                                <basis core="external.ws.ws" service="kipaaPayment" name="kipaa" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="verify_transaction" sort="random" preview="">
                                        <params>
                                            <param name="payment_token" value="[##db.get_inputs_id.Value##]" />
                                            <param name="reciept_number" value="[##cms.form.reciept_number##]" />
                                            <param name="token" value="[##db.token.Value##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="answer" format="json"
                                            postsql="select value from [db.answer] where field = 'answer'" preview="">
                                            {"root":[##kipaa.m1.result##]}
                                        </member>
                                        <member name="Success" format="json"
                                            postsql="select value from [db.Success] where field = 'Success'" preview="">
                                            {"root":[##db.answer.Value##]}
                                        </member>
                                        <member name="CallingID" format="json"
                                            postsql="select value from [db.CallingID] where field = 'CallingID'"
                                            preview="">
                                            {"root":[##db.answer.Value##]}
                                        </member>
                                    </basis>
                                    <basis core="group" if="'[##db.Success.Value##]' = 'true'">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="13" invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid="" paymentid=""
                                            refnumber="[##db.CallingID.Value##]" status="1" token="" result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group" if="'[##db.Success.Value##]' <> 'true'">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="13" invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid="" paymentid=""
                                            refnumber="[##db.CallingID.Value##]" status="0" token="" result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.Success.Value##]' name="token" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                [##db.CallingID.Value##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.Success.Value##]'='true'"> <span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.Success.Value##]'<>'true'"> <span
                                                    class="resulF">Unsuccessful</span></basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>

                        </basis>
                        <basis core="group" name="Sepah" if="[##db.get_inputs_bank_id.Value##] = 54">
                            <basis core="inlinesource" name="db">
                                <member name="token" format="json"
                                    postsql="select value from [db.token] where field = 'token'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="Sepah">
                                <basis core="external.ws.ws" service="newSepah" name="sepah" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="ConfirmPayment" sort="random" preview="">
                                        <params>
                                            <param name="LoginAccount" value="[##db.token.Value##]" />
                                            <param name="Token" value="[##cms.form.Token##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="Status" format="json"
                                            postsql="select value from [db.Status] where field = 'Status'" preview="">
                                            {"root":[##sepah.m1.result##]}
                                        </member>
                                        <member name="CardNumberMasked" format="json"
                                            postsql="select value from [db.CardNumberMasked] where field = 'CardNumberMasked'"
                                            preview="">
                                            {"root":[##sepah.m1.result##]}
                                        </member>
                                        <member name="RRN" format="json"
                                            postsql="select value from [db.RRN] where field = 'RRN'" preview="">
                                            {"root":[##sepah.m1.result##]}
                                        </member>
                                    </basis>
                                    <basis core="group" if="'[##db.Status.Value##]' = 'false'">
                                        <basis core="group" if="'[##db.RRN.Value##]' <> 'false' ">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="14" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##db.CardNumberMasked.Value##]" hashedcardno="" merchantid=""
                                                paymentid="" refnumber="[##db.RRN.Value##]" status="1" token=""
                                                result="1">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                        </basis>

                                    </basis>
                                    <basis core="group" if="'[##db.Status.Value##]' <> 'false'">
                                        <basis core="group" if="'[##db.RRN.Value##]' ='false'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="14" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##db.CardNumberMasked.Value##]" hashedcardno="" merchantid=""
                                                paymentid="" refnumber="[##db.RRN.Value##]" status="0" token=""
                                                result="0">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                        </basis>

                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.Status.Value##]' name="token" />
                                        <input type="hidden" value='[##db.RRN.Value##]' name="RRN" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                [##db.RRN.Value##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                style="display:inline-block; direction:ltr;">
                                                [##db.CardNumberMasked.Value##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.Status.Value##]'='false'"> <span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.Status.Value##]'<>'false'"> <span
                                                    class="resulF">Unsuccessful</span>
                                            </basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>
                        </basis>
                        <basis core="group" name="aghayePardakht" if="[##db.get_inputs_bank_id.Value##] = 55">
                            <basis core="inlinesource" name="db">
                                <member name="token" format="json"
                                    postsql="select value from [db.token] where field = 'token'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="aghayePardakht">
                                <basis core="external.ws.ws" service="aghayePardakht" name="aghayePardakht"
                                    source="cmsDbService" procedurename="sbserviceprocedure1">
                                    <member name="m1" method="verify" sort="random" preview="">
                                        <params>
                                            <param name="pin" value="[##db.token.Value##]" />
                                            <param name="amount" value="[##db.get_inputs_totalfinal.Value##]" />
                                            <param name="transid" value="[##cms.form.transid##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="response" format="json"
                                            postsql="select value from [db.response] where field = 'response'"
                                            preview="">
                                            {"root":[##aghayePardakht.m1.result##]}
                                        </member>
                                    </basis>
                                    <basis core="group" if="'[##db.response.Value##]' = '1'">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="15" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                            cardno="[##cms.form.cardnumber##]" hashedcardno="" merchantid=""
                                            paymentid="" refnumber="[##cms.form.tracking_number##]" status="1" token=""
                                            result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group" if="'[##db.response.Value##]' <> '1'">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="15" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                            cardno="[##cms.form.cardnumber##]" hashedcardno="" merchantid=""
                                            paymentid="" refnumber="[##cms.form.tracking_number##]" status="0" token=""
                                            result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.response.Value##]' name="token" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                [##cms.form.tracking_number##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                style="display:inline-block; direction:ltr;">
                                                [##cms.form.cardnumber##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.response.Value##]'='1'"> <span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.response.Value##]'<>'1'"> <span
                                                    class="resulF">Unsuccessful</span>
                                            </basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>
                        </basis>
                        <basis core="group" name="ayandeh" if="[##db.get_inputs_bank_id.Value##] = 57">
                            <basis core="inlinesource" name="db">
                                <member name="username" format="json"
                                    postsql="select value from [db.username] where field = 'username'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="password" format="json"
                                    postsql="select value from [db.password] where field = 'password'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="ayandehall">
                                <basis core="external.ws.ws" service="ayandeh" name="ayandeh" source="cmsDbService"
                                    procedurename="sbserviceprocedure1">
                                    <member name="m1" method="verify" sort="random" preview="">
                                        <params>
                                            <param name="username" value="[##db.username.Value##]" />
                                            <param name="password" value="[##db.password.Value##]" />
                                            <param name="traceNumber" value="[##cms.form.traceNumber##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="result" format="json"
                                            postsql="select value from [db.result] where field = 'result'">
                                            {"root":[##ayandeh.m1.result##]} </member>
                                        <member name="doTime" format="json"
                                            postsql="select value from [db.doTime] where field = 'doTime'">
                                            {"root":[##ayandeh.m1.result##]} </member>
                                        <member name="description" format="json"
                                            postsql="select value from [db.description] where field = 'description'">
                                            {"root":[##ayandeh.m1.result##]} </member>
                                    </basis>
                                    <basis core="group" if="'[##db.result.Value##]' = '0'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="16"
                                            invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid="" paymentid=""
                                            refnumber="[##cms.form.traceNumber##]" status="1" token="" result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group" if="'[##db.result.Value##]' <> '0'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="16"
                                            invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid="" paymentid=""
                                            refnumber="[##cms.form.traceNumber##]" status="0" token="" result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.result.Value##]' name="token" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##cms.form.ResNum##]" name="ResNum" />
                                        <input type="hidden" value="[##cms.form.SecurePan##]" name="SecurePan" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction time : </span> <span>
                                                [##db.doTime.value##] </span></div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                [##cms.form.traceNumber##] </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.result.Value##]'='0'"><span class="resultT"
                                                    id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.result.Value##]'<>'0'"><span
                                                    class="resulF">Unsuccessful</span>
                                            </basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>
                        </basis>
                        <basis core="group" name="ArcaPayment" if="[##db.get_inputs_bank_id.Value##] = 59">

                            <basis core="inlinesource" name="db">
                                <member name="username" format="json" preview=""
                                    postsql="select value from [db.username] where field = 'username'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="password" format="json" preview=""
                                    postsql="select value from [db.password] where field = 'password'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="bank-Delay_1">
                                <basis core="external.ws.ws" service="ArcaPayment" name="ArcaPayment"
                                    source="cmsDbService" procedurename="sbserviceprocedure1">
                                    <member name="m1" method="getOrderStatus" sort="random" preview="">
                                        <params>
                                            <param name="orderId" value="[##cms.query.orderId##]" />
                                            <param name="userName" value="[##db.username.Value##]" />
                                            <param name="password" value="[##db.password.Value##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="bank-Delay_2">
                                    <basis core="inlinesource" name="db">
                                        <member name="answer" format="json"
                                            postsql="select  Value  from [db.answer] where field = 'answer'" preview="">
                                            {"root":[##ArcaPayment.m1.result##]}
                                        </member>
                                    </basis>
                                    <basis core="group" name="json">
                                        <basis core="inlinesource" name="db">
                                            <member name="errorCode" format="json"
                                                postsql="select  Value  from [db.errorCode] where field = 'errorCode'"
                                                preview="">
                                                {"root":[##db.answer.Value##]}
                                            </member>
                                            <member name="approvalCode" format="json"
                                                postsql="select  Value  from [db.approvalCode] where field = 'approvalCode'"
                                                preview="">
                                                {"root":[##db.answer.Value##]}
                                            </member>
                                            <member name="pan" format="json"
                                                postsql="select  Value  from [db.pan] where field = 'pan'" preview="">
                                                {"root":[##db.answer.Value##]}
                                            </member>
                                        </basis>
                                        <basis core="group" if="'[##db.errorCode.Value##]' = '0'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="17" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##db.pan.Value##]" hashedcardno="" merchantid="" paymentid=""
                                                refnumber="[##db.approvalCode.Value##]"
                                                status="[##db.errorCode.Value##]" token="" result="1">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <basis core="group" if="'[##db.errorCode.Value##]' <> '0'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="17" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##db.pan.Value##]" hashedcardno="" merchantid="" paymentid=""
                                                refnumber="[##db.approvalCode.Value##]"
                                                status="[##db.errorCode.Value##]" token="" result="0">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                            class="formbank">
                                            <input type="hidden" value='[##db.errorCode.Value##]' name="errorCode" />
                                            <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                            <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                            <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                                name="factorid" />
                                            <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                                name="agencyid" />
                                            <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                                name="supplier" />
                                            <input type="hidden" value="[##db.get_inputs_paytype.Value##]"
                                                name="paytype" />
                                            <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                                name="trackingid" />
                                            <input type="hidden" value="[##db.get_inputs_bank_id.Value##]"
                                                name="bank_id" />
                                            <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                                name="factortype" />
                                            <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                                name="paymentid" />
                                        </form>
                                        <div class="factor-info">
                                            <div class="factor-title"><span>Summary of transaction status :</span></div>
                                            <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                    style="display:inline-block; direction:ltr;">
                                                    [##db.pan.Value##]</span></div>
                                            <div class="eachInfo"><span class="backq">Transaction amount : </span>
                                                <span>
                                                    <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                    [##db.unit_title.Value##] </span>
                                            </div>
                                            <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                    [##db.approvalCode.Value##] </span></div>
                                            <div class="eachInfo"><span class="backq">Transaction status : </span>
                                                <basis core="group" if="'[##db.errorCode.Value##]'='0'"> <span
                                                        class="resultT" id="resulTimeout">Successful</span></basis>
                                                <basis core="group" if="'[##db.errorCode.Value##]' not in ('0')">
                                                    <span class="resulF">Unsuccessful</span>
                                                </basis>
                                            </div>
                                        </div>
                                    </basis>
                                    <script type="text/javascript">
                                        $.ajax({
                                            type: "POST",
                                            url: "/Client_Final_Payment_en.bc",
                                            data: $(".formbank").serialize(),
                                            dataType: "html",
                                            success: function (response) {
                                                $(".sectionInfo").empty().html(response);
                                            }
                                        });
                                        $(".amount").text(function (index, value) {
                                            return value
                                                .replace(/\D/g, "")
                                                .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                        });
                                    </script>
                                </basis>
                            </basis>
                        </basis>
                        <basis core="group" name="refah" if="[##db.get_inputs_bank_id.Value##] = 65">
                            <basis core="inlinesource" name="db">
                                <member name="terminalid" format="json"
                                    postsql="select value from [db.terminalid] where field = 'terminalid'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="refah">
                                <basis core="external.ws.ws" service="refah" name="refah" source="cmsDbService"
                                    procedurename="sbserviceprocedure1">
                                    <member name="m1" method="verifyTransaction" sort="random" preview="">
                                        <params>
                                            <param name="َAction" value="verifyTransaction" />
                                            <param name="RefNum" value="[##cms.query.RefNum##]" />
                                            <param name="TerminalId" value="[##db.terminalid.Value##]" />
                                            <param name="AffectiveAmount"
                                                value="[##db.get_inputs_totalfinal.Value##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="status" format="json"
                                            postsql="select value from [db.status] where field = 'status'" preview="">
                                            {"root":[##refah.m1.result##]}
                                        </member>
                                    </basis>

                                    <basis core="group" if="'[##db.status.Value##]' = 'true'">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="18" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                            cardno="[##cms.query.SecurePan##]"
                                            hashedcardno="[##cms.query.HashedCardNumber##]" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##cms.query.TraceNo##]" status="1" token="[##cms.query.Token##]"
                                            result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group" if="'[##db.status.Value##]' <> 'true'">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="18" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                            cardno="[##cms.query.SecurePan##]"
                                            hashedcardno="[##cms.query.HashedCardNumber##]" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##cms.query.TraceNo##]" status="0" token="[##cms.query.Token##]"
                                            result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.status.Value##]' name="token" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                [##cms.query.TraceNo##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                style="display:inline-block; direction:ltr;">
                                                [##cms.query.SecurePan##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.status.Value##]'='true'"> <span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.status.Value##]'<>'true'"> <span
                                                    class="resulF">Unsuccessful</span>
                                            </basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>
                        </basis>
                        <basis core="group" name="shahr" if="[##db.get_inputs_bank_id.Value##] = 66">
                            <basis core="inlinesource" name="db">
                                <member name="usr" format="json"
                                    postsql="select value from [db.usr] where field = 'usr'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="pwd" format="json"
                                    postsql="select value from [db.pwd] where field = 'pwd'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="shahr">
                                <basis core="external.ws.ws" service="shahrBank" name="shahr" source="cmsDbService"
                                    procedurename="sbserviceprocedure1">
                                    <member name="m1" method="verify" sort="random" preview="">
                                        <params>
                                            <param name="usr" value="[##db.usr.value##]" />
                                            <param name="pwd" value="[##db.pwd.value##]" />
                                            <param name="merchantConfigurationId"
                                                value="[##cms.query.merchantConfigurationId##]" />
                                            <param name="localInvoiceId" value="[##cms.query.localInvoiceId##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="Status" format="json"
                                            postsql="select value from [db.Status] where field = 'Status'" preview="">
                                            {"root":[##shahr.m1.result##]}
                                        </member>
                                    </basis>

                                    <basis core="group" if="'[##db.Status.Value##]' = '200'">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="19" invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##cms.form.PayGateTranID##]" status="1" token="" result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group" if="'[##db.Status.Value##]' <> '200'">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="19" invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##cms.form.PayGateTranID##]" status="0" token="" result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.Status.Value##]' name="token" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                [##cms.form.PayGateTranID##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.Status.Value##]'='200'"> <span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.Status.Value##]'<>'200'"> <span
                                                    class="resulF">Unsuccessful</span>
                                            </basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>
                        </basis>
                        <basis core="group" name="fadax" if="[##db.get_inputs_bank_id.Value##] = 69">
                            <basis core="inlinesource" name="db">
                                <member name="get_inputs_paymentToken" format="json"
                                    postsql="select  value  from [db.get_inputs_paymentToken] as a where Field = 'paymentToken'"
                                    preview="">
                                    {"root":[##db.get_inputs.result##]}</member>
                                <member name="get_inputs_token_jwt" format="json"
                                    postsql="select  value  from [db.get_inputs_token_jwt] as a where Field = 'token_jwt'"
                                    preview="">
                                    {"root":[##db.get_inputs.result##]}</member>
                            </basis>
                            <basis core="group" name="fadax">
                                <basis core="external.ws.ws" service="fadaxPayment" name="fadax" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="verify" sort="random" preview="">
                                        <params>
                                            <param name="paymentToken" value="[##db.get_inputs_paymentToken.Value##]" />
                                            <param name="token_jwt" value="[##db.get_inputs_token_jwt.Value##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="verify" format="json"
                                            postsql="select value from [db.verify] where field = 'verify'" preview="">
                                            {"root":[##fadax.m1.result##]}
                                        </member>
                                        <member name="success" format="json"
                                            postsql="select value from [db.success] where field = 'success'" preview="">
                                            {"root":[##db.verify.Value##]}
                                        </member>
                                        <member name="transactionId" format="json"
                                            postsql="select value from [db.transactionId] where field = 'transactionId'"
                                            preview="">
                                            {"root":[##fadax.m1.result##]}
                                        </member>
                                    </basis>
                                    <basis core="group"
                                        if="'[##db.success.Value##]' = 'true' and '[##db.transactionId.Value##]' <> ''">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="20" invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##db.transactionId.Value##]" status="1" token="" result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group"
                                        if="'[##db.success.Value##]' <> 'true' and '[##db.transactionId.Value##]' = ''">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="20" invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##db.transactionId.Value##]" status="0" token="" result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.success.Value##]' name="token" />
                                        <input type="hidden" value='[##db.transactionId.Value##]'
                                            name="transactionId" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                [##db.transactionId.Value##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.success.Value##]'='true'"> <span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.success.Value##]'<>'true'"> <span
                                                    class="resulF">Unsuccessful</span>
                                            </basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>
                        </basis>
                        <basis core="group" name="fadaxMellat" if="[##db.get_inputs_bank_id.Value##] = 199">
                            <basis core="inlinesource" name="db">
                                <member name="get_inputs_paymentToken" format="json"
                                    postsql="select  value  from [db.get_inputs_paymentToken] as a where Field = 'paymentToken'"
                                    preview="">
                                    {"root":[##db.get_inputs.result##]}</member>
                                <member name="get_inputs_token_jwt" format="json"
                                    postsql="select  value  from [db.get_inputs_token_jwt] as a where Field = 'token_jwt'"
                                    preview="">
                                    {"root":[##db.get_inputs.result##]}</member>
                            </basis>
                            <basis core="group" name="fadaxMellat">
                                <basis core="external.ws.ws" service="fadaxMellat" name="fadax" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="verify" sort="random" preview="">
                                        <params>
                                            <param name="paymentToken" value="[##db.get_inputs_paymentToken.Value##]" />
                                            <param name="token_jwt" value="[##db.get_inputs_token_jwt.Value##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="verify" format="json"
                                            postsql="select value from [db.verify] where field = 'verify'" preview="">
                                            {"root":[##fadax.m1.result##]}
                                        </member>
                                        <member name="success" format="json"
                                            postsql="select value from [db.success] where field = 'success'" preview="">
                                            {"root":[##db.verify.Value##]}
                                        </member>
                                        <member name="transactionId" format="json"
                                            postsql="select value from [db.transactionId] where field = 'transactionId'"
                                            preview="">
                                            {"root":[##fadax.m1.result##]}
                                        </member>
                                    </basis>
                                    <basis core="group"
                                        if="'[##db.success.Value##]' = 'true' and '[##db.transactionId.Value##]' <> ''">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="30" invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##db.transactionId.Value##]" status="1" token="" result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group"
                                        if="'[##db.success.Value##]' <> 'true' and '[##db.transactionId.Value##]' = ''">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="30" invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##db.transactionId.Value##]" status="0" token="" result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.success.Value##]' name="token" />
                                        <input type="hidden" value='[##db.transactionId.Value##]'
                                            name="transactionId" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                [##db.transactionId.Value##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.success.Value##]'='true'"> <span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.success.Value##]'<>'true'"> <span
                                                    class="resulF">Unsuccessful</span>
                                            </basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>
                        </basis>
                        <basis core="group" name="clover" if="[##db.get_inputs_bank_id.Value##] = 71">
                            <basis core="inlinesource" name="db">
                                <member name="access_token" format="json"
                                    postsql="select value from [db.access_token] where field = 'access_token'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="apiAccessKey" format="json"
                                    postsql="select value from [db.apiAccessKey] where field = 'apiAccessKey'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="currency" format="json"
                                    postsql="select value from [db.currency] where field = 'currency'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="clover">
                                <basis core="external.ws.ws" service="CloverPayment" name="CloverPayment"
                                    source="cmsDbService" procedurename="sbserviceprocedure1" preview="true">
                                    <member name="m1" method="payment" sort="random">
                                        <params>
                                            <param name="card_number" value="[##cms.form.cardnumber##]" />
                                            <param name="exp_month" value="[##cms.form.expmonth##]" />
                                            <param name="exp_year" value="[##cms.form.expyear##]" />
                                            <param name="cvv" value="[##cms.form.cvv##]" />
                                            <param name="brand" value="[##cms.form.cardtype##]" />
                                            <param name="access_token" value="[##db.access_token.value##]" />
                                            <param name="apiAccessKey" value="[##db.apiAccessKey.value##]" />
                                            <param name="amount" value="[##db.get_inputs_totalfinal.Value##]" />
                                            <param name="currency" value="[##db.currency.value##]" />
                                        </params>
                                    </member>
                                </basis>

                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="status" format="json"
                                            postsql="select value from [db.status] where field = 'status'" preview="">
                                            {"root":[##CloverPayment.m1.result##]}
                                        </member>
                                        <member name="ref_num" format="json"
                                            postsql="select value from [db.ref_num] where field = 'ref_num'" preview="">
                                            {"root":[##CloverPayment.m1.result##]}
                                        </member>
                                        <member name="first6" format="json"
                                            postsql="select value from [db.first6] where field = 'first6'" preview="">
                                            {"root":[##CloverPayment.m1.result##]}
                                        </member>
                                        <member name="last4" format="json"
                                            postsql="select value from [db.last4] where field = 'last4'" preview="">
                                            {"root":[##CloverPayment.m1.result##]}
                                        </member>
                                    </basis>

                                    <basis core="group" if="'[##db.Status.Value##]' = 'succeeded'">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="21" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                            cardno="[##db.first6.Value##]******[##db.last4.Value##]" hashedcardno=""
                                            merchantid="" paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##db.ref_num.Value##]" status="1" token="" result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group" if="'[##db.Status.Value##]' <> 'succeeded'">
                                        <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                            bankid="21" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                            cardno="[##db.first6.Value##]******[##db.last4.Value##]" hashedcardno=""
                                            merchantid="" paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##db.ref_num.Value##]" status="0" token="" result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.Status.Value##]' name="token" />
                                        <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                [##db.ref_num.Value##]</span></div>
                                        <div class="eachInfo"><span class="backq">Card number: </span>
                                            <span>[##db.first6.Value##]******[##db.last4.Value##]</span>
                                        </div>
                                        <div class="eachInfo"><span class="backq">Transaction amount : </span> <span>
                                                <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                [##db.unit_title.Value##]
                                            </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.Status.Value##]'='succeeded'"> <span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.Status.Value##]'<>'succeeded'"> <span
                                                    class="resulF">Unsuccessful</span>
                                            </basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $(document).ready(function () {
                                        var url = "/Client_Final_Payment_en.bc";
                                        $.ajax({
                                            type: "POST",
                                            url: url,
                                            data: $(".formbank").serialize(),
                                            dataType: "html",
                                            success: function (response) {
                                                $(".sectionInfo").empty().html(response);
                                            }
                                        });
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>
                        </basis>
                        <basis core="group" name="Rayancard" if="[##db.get_inputs_bank_id.Value##] = 73">
                            <basis core="inlinesource" name="db">
                                <member name="password" format="json" preview=""
                                    postsql="select value from [db.password] where field = 'password'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="Rayan">
                                <basis core="external.ws.ws" service="rayanCardPayment" name="rayancard"
                                    source="cmsDbService" procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="verify" sort="random">
                                        <params>
                                            <param name="token" value="[##cms.form.token##]" />
                                            <param name="password" value="[##db.password.Value##]" />
                                            <param name="verify" value="[##cms.form.orderId##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="DelayPay">
                                    <basis core="inlinesource" name="db">
                                        <member name="status" format="json"
                                            postsql="select  Value  from [db.status] where field = 'wasSuccessful'"
                                            preview="">
                                            {"root":[##rayancard.m1.result##]}</member>
                                        <member name="transId" format="json"
                                            postsql="select  Value  from [db.transId] where field = 'orderId'"
                                            preview="">
                                            {"root":[##rayancard.m1.result##]}</member>
                                        <member name="cardNumber" format="json"
                                            postsql="select  Value  from [db.cardNumber] where field = 'cardMaskPan'"
                                            preview="">
                                            {"root":[##rayancard.m1.result##]}</member>
                                        <member name="factorNumber" format="json"
                                            postsql="select  Value  from [db.factorNumber] where field = 'factorNumber'"
                                            preview="">{"root":[##rayancard.m1.result##]}</member>
                                    </basis>
                                    <basis core="group" name="Delayrayancard2">

                                        <basis core="group" if="'[##db.status.Value##]' = 'true'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="22" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##db.cardNumber.Value##]" hashedcardno="" merchantid=""
                                                paymentid="[##db.get_inputs_paymentid.Value##]"
                                                refnumber="[##db.transId.Value##]" status="1"
                                                token="[##cms.form.token##]" result="1">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <basis core="group" if="'[##db.status.Value##]' <> 'true'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="22" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##db.cardNumber.Value##]" hashedcardno="" merchantid=""
                                                paymentid="[##db.get_inputs_paymentid.Value##]"
                                                refnumber="[##db.transId.Value##]" status="0"
                                                token="[##cms.form.token##]" result="0">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                            class="formbank">
                                            <input type="hidden" value='[##db.status.Value##]' name="token" />
                                            <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                            <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                            <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                                name="factorid" />
                                            <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                                name="agencyid" />
                                            <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                                name="supplier" />
                                            <input type="hidden" value="[##db.get_inputs_paytype.Value##]"
                                                name="paytype" />
                                            <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                                name="trackingid" />
                                            <input type="hidden" value="[##db.get_inputs_bank_id.Value##]"
                                                name="bank_id" />
                                            <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                                name="factortype" />
                                            <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                                name="paymentid" />
                                        </form>
                                        <div class="factor-info">
                                            <div class="factor-title"><span>Summary of transaction status :</span></div>
                                            <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                    [##db.transId.Value##]</span></div>
                                            <div class="eachInfo"><span class="backq">Transaction amount : </span>
                                                <span>
                                                    <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                    [##db.unit_title.Value##]
                                                </span>
                                            </div>
                                            <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                    style="display:inline-block; direction:ltr;">
                                                    [##db.cardNumber.Value##]</span></div>
                                            <div class="eachInfo"><span class="backq">Transaction status : </span>
                                                <basis core="group" if="'[##db.status.Value##]'='true'"> <span
                                                        class="resultT" id="resulTimeout">Successful</span></basis>
                                                <basis core="group" if="'[##db.status.Value##]'<>'true'"> <span
                                                        class="resulF">Unsuccessful</span>
                                                </basis>
                                            </div>
                                        </div>
                                    </basis>
                                </basis>
                            </basis>

                            <script type="text/javascript">
                                $.ajax({
                                    type: "POST",
                                    url: "/Client_Final_Payment_en.bc",
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                    }
                                });
                                $(".amount").text(function (index, value) {
                                    return value
                                        .replace(/\D/g, "")
                                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                });
                            </script>


                        </basis>
                        <basis core="group" name="IranKishcard" if="[##db.get_inputs_bank_id.Value##] = 77">
                            <basis core="inlinesource" name="db">
                                <member name="terminalid" format="json"
                                    postsql="select value from [db.terminalid] where field = 'terminalid'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="IranKish">
                                <basis core="external.ws.ws" service="IranKishPayment" name="irankish"
                                    source="cmsDbService" procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="verify" sort="random">
                                        <params>
                                            <param name="terminalId" value="[##db.terminalid.Value##]" />
                                            <param name="retrievalReferenceNumber"
                                                value="[##cms.form.retrievalReferenceNumber##]" />
                                            <param name="systemTraceAuditNumber"
                                                value="[##cms.form.systemTraceAuditNumber##]" />
                                            <param name="tokenIdentity" value="[##cms.form.token##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="DelayPay">
                                    <basis core="inlinesource" name="db">
                                        <member name="status" format="json"
                                            postsql="select  Value  from [db.status] where field = 'status'" preview="">
                                            {"root":[##irankish.m1.result##]}</member>
                                        <member name="systemTraceAuditNumber" format="json"
                                            postsql="select  Value  from [db.systemTraceAuditNumber] where field = 'systemTraceAuditNumber'"
                                            preview="">
                                            {"root":[##irankish.m1.result##]}</member>
                                    </basis>
                                    <basis core="group" name="DelayIranKishcard2">

                                        <basis core="group" if="'[##db.status.Value##]' = 'true'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="23" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##cms.form.maskedPan##]"
                                                hashedcardno="[##cms.form.maskedPan##]"
                                                merchantid="[##cms.form.merchantid##]"
                                                paymentid="[##db.get_inputs_paymentid.Value##]"
                                                refnumber="[##db.systemTraceAuditNumber.Value##]" status="1"
                                                token="[##cms.form.token##]" result="1">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <basis core="group" if="'[##db.status.Value##]' <> 'true'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="23" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##cms.form.maskedPan##]"
                                                hashedcardno="[##cms.form.maskedPan##]"
                                                merchantid="[##cms.form.merchantid##]"
                                                paymentid="[##db.get_inputs_paymentid.Value##]"
                                                refnumber="[##db.systemTraceAuditNumber.Value##]" status="0"
                                                token="[##cms.form.token##]" result="0">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                            class="formbank">
                                            <input type="hidden" value='[##db.status.Value##]' name="token" />
                                            <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                            <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                            <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                                name="factorid" />
                                            <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                                name="agencyid" />
                                            <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                                name="supplier" />
                                            <input type="hidden" value="[##db.get_inputs_paytype.Value##]"
                                                name="paytype" />
                                            <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                                name="trackingid" />
                                            <input type="hidden" value="[##db.get_inputs_bank_id.Value##]"
                                                name="bank_id" />
                                            <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                                name="factortype" />
                                            <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                                name="paymentid" />
                                            <input type="hidden" value="[##db.get_inputs_totalfinal.Value##]"
                                                name="amount" />
                                            <input type="hidden" value="" name="firstName" class="user-info-1" />
                                            <input type="hidden" value="" name="lastName" class="user-info-2" />
                                            <input type="hidden" value="" name="mobile" class="user-info-5" />
                                        </form>
                                        <div class="factor-info">
                                            <div class="factor-title"><span>Summary of transaction status :</span></div>
                                            <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                    [##db.systemTraceAuditNumber.Value##]</span></div>
                                            <div class="eachInfo"><span class="backq">Transaction amount : </span>
                                                <span>
                                                    <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                    [##db.unit_title.Value##]
                                                </span>
                                            </div>
                                            <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                    style="display:inline-block; direction:ltr;">
                                                    [##cms.form.maskedPan##]</span></div>
                                            <div class="eachInfo"><span class="backq">Transaction status : </span>
                                                <basis core="group" if="'[##db.status.Value##]'='true'"> <span
                                                        class="resultT" id="resulTimeout">Successful</span></basis>
                                                <basis core="group" if="'[##db.status.Value##]'<>'true'"> <span
                                                        class="resulF">Unsuccessful</span>
                                                </basis>
                                            </div>
                                        </div>
                                    </basis>
                                </basis>
                            </basis>
                            <script type="text/javascript">
                                $.ajax({
                                    type: "POST",
                                    url: "/Client_Final_Payment_en.bc",
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                    }
                                });
                                $(".amount").text(function (index, value) {
                                    return value
                                        .replace(/\D/g, "")
                                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                });
                            </script>
                        </basis>
                        <basis core="group" name="BasaPayment" if="[##db.get_inputs_bank_id.Value##] = 85">
                            <basis core="inlinesource" name="db">
                                <member name="password" format="json" preview=""
                                    postsql="select value from [db.password] where field = 'password'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="Basa">
                                <basis core="external.ws.ws" service="basaPayment" name="basa" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="verify" sort="random">
                                        <params>
                                            <param name="token" value="[##cms.form.token##]" />
                                            <param name="password" value="[##db.password.Value##]" />
                                            <param name="verify" value="[##cms.form.orderId##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="DelayPay">
                                    <basis core="inlinesource" name="db">
                                        <member name="status" format="json"
                                            postsql="select  Value  from [db.status] where field = 'wasSuccessful'"
                                            preview="">
                                            {"root":[##basa.m1.result##]}</member>
                                        <member name="transId" format="json"
                                            postsql="select  Value  from [db.transId] where field = 'orderId'"
                                            preview="">
                                            {"root":[##basa.m1.result##]}</member>
                                        <member name="cardNumber" format="json"
                                            postsql="select  Value  from [db.cardNumber] where field = 'cardMaskPan'"
                                            preview="">
                                            {"root":[##basa.m1.result##]}</member>
                                        <member name="factorNumber" format="json"
                                            postsql="select  Value  from [db.factorNumber] where field = 'factorNumber'"
                                            preview="">{"root":[##basa.m1.result##]}</member>
                                    </basis>
                                    <basis core="group" name="Delaybasa2">

                                        <basis core="group" if="'[##db.status.Value##]' = 'true'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="24" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##db.cardNumber.Value##]" hashedcardno="" merchantid=""
                                                paymentid="[##db.get_inputs_paymentid.Value##]"
                                                refnumber="[##db.transId.Value##]" status="1"
                                                token="[##cms.form.token##]" result="1">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <basis core="group" if="'[##db.status.Value##]' <> 'true'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="24" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##db.cardNumber.Value##]" hashedcardno="" merchantid=""
                                                paymentid="[##db.get_inputs_paymentid.Value##]"
                                                refnumber="[##db.transId.Value##]" status="0"
                                                token="[##cms.form.token##]" result="0">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                            class="formbank">
                                            <input type="hidden" value='[##db.status.Value##]' name="token" />
                                            <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                            <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                            <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                                name="factorid" />
                                            <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                                name="agencyid" />
                                            <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                                name="supplier" />
                                            <input type="hidden" value="[##db.get_inputs_paytype.Value##]"
                                                name="paytype" />
                                            <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                                name="trackingid" />
                                            <input type="hidden" value="[##db.get_inputs_bank_id.Value##]"
                                                name="bank_id" />
                                            <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                                name="factortype" />
                                            <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                                name="paymentid" />
                                        </form>
                                        <div class="factor-info">
                                            <div class="factor-title"><span>Summary of transaction status :</span></div>
                                            <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                    [##db.transId.Value##]</span></div>
                                            <div class="eachInfo"><span class="backq">Transaction amount : </span>
                                                <span>
                                                    <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                    [##db.unit_title.Value##]
                                                </span>
                                            </div>
                                            <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                    style="display:inline-block; direction:ltr;">
                                                    [##db.cardNumber.Value##]</span></div>
                                            <div class="eachInfo"><span class="backq">Transaction status : </span>
                                                <basis core="group" if="'[##db.status.Value##]'='true'"> <span
                                                        class="resultT" id="resulTimeout">Successful</span></basis>
                                                <basis core="group" if="'[##db.status.Value##]'<>'true'"> <span
                                                        class="resulF">Unsuccessful</span>
                                                </basis>
                                            </div>
                                        </div>
                                    </basis>
                                </basis>
                            </basis>

                            <script type="text/javascript">
                                $.ajax({
                                    type: "POST",
                                    url: "/Client_Final_Payment_en.bc",
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                    }
                                });
                                $(".amount").text(function (index, value) {
                                    return value
                                        .replace(/\D/g, "")
                                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                });
                            </script>


                        </basis>
                        <basis core="group" name="pasargad2" if="[##db.get_inputs_bank_id.Value##] = 95">
                            <basis core="inlinesource" name="db">
                                <member name="username" format="json"
                                    postsql="select value from [db.username] where field = 'username'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="password" format="json"
                                    postsql="select value from [db.password] where field = 'password'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="get_inputs_urlId" format="json"
                                    postsql="select  value  from [db.get_inputs_urlId] as a where Field = 'urlId'"
                                    preview="">{"root":[##db.get_inputs.result##]}</member>
                            </basis>
                            <basis core="group" name="json">
                                <basis core="external.ws.ws" service="pasargad2" name="pasargad_verify"
                                    source="cmsDbService" procedurename="sbserviceprocedure1" preview="true">
                                    <member name="m1" method="verify" sort="random" preview="">
                                        <params>
                                            <param name="paymentid" value="[##db.get_inputs_paymentid.Value##]" />
                                            <param name="urlId" value="[##db.get_inputs_urlId.Value##]" />
                                            <param name="username" value="[##db.username.Value##]" />
                                            <param name="password" value="[##db.password.Value##]" />
                                            <param name="dmnid" value="[##cms.cms.domainid##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="Status" format="json"
                                            postsql="select  value  from [db.Status] as a where field = 'resultCode'"
                                            preview=""> {"root":[##pasargad_verify.m1.result##]}</member>
                                    </basis>
                                    <basis core="group" if="'[##cms.query.status##]'= 'success'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="25"
                                            invoicenumber="[##cms.query.invoiceId##]" cardno="" hashedcardno=""
                                            merchantid="" paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##cms.query.referenceNumber##]" status="1" token="" result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group" if="'[##cms.query.status##]' <> 'success'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="25"
                                            invoicenumber="[##cms.query.invoiceId##]" cardno="" hashedcardno=""
                                            merchantid="" paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##cms.query.referenceNumber##]" status="0" token="" result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##cms.query.status##]' name="token" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                        <input type="hidden" value="[##db.get_inputs_totalfinal.Value##]"
                                            name="amount" />
                                        <!-- updated login -->
                                        <input type="hidden" value="" name="firstName" class="user-info-1" />
                                        <input type="hidden" value="" name="lastName" class="user-info-2" />
                                        <input type="hidden" value="" name="mobile" class="user-info-5" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount :
                                            </span><span><span
                                                    class="amount">[##db.get_inputs_totalfinal.Value##]</span>[##db.unit_title.Value##]</span>
                                        </div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking :
                                            </span><span>[##cms.query.referenceNumber##] </span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##cms.query.status##]'='success'"><span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##cms.query.status##]'<>'success'"><span
                                                    class="resulF">پرداخت Unsuccessful</span></basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>
                        </basis>
                        <basis core="group" name="siBank" if="[##db.get_inputs_bank_id.Value##] = 97">
                            <basis core="inlinesource" name="db">
                                <member name="username" format="json"
                                    postsql="select value from [db.username] where field = 'username'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="password" format="json"
                                    postsql="select value from [db.password] where field = 'password'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="merchant" format="json"
                                    postsql="select value from [db.merchant] where field = 'merchant'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                                <member name="get_inputs_transaction_id" format="json"
                                    postsql="select  value  from [db.get_inputs_transaction_id] as a where Field = 'transaction_id'"
                                    preview="">
                                    {"root":[##db.get_inputs.result##]}</member>
                            </basis>
                            <basis core="group" name="json">
                                <basis core="external.ws.ws" service="siBank" name="si" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="true">
                                    <member name="m1" method="verify" sort="random">
                                        <params>
                                            <param name="transaction_id"
                                                value="[##db.get_inputs_transaction_id.Value##]" />
                                            <param name="username" value="[##db.username.Value##]" />
                                            <param name="password" value="[##db.password.Value##]" />
                                            <param name="merchant" value="[##db.merchant.Value##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="Status" format="json"
                                            postsql="select  value  from [db.Status] as a where field = 'success'"
                                            preview="">
                                            {"root":[##si.m1.result##]}</member>
                                    </basis>
                                    <basis core="group" if="'[##db.Status.Value##]'= 'true'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="27"
                                            invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##db.get_inputs_factorid.Value##]" status="1" token=""
                                            result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group" if="'[##db.Status.Value##]' <> 'true'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="27"
                                            invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##db.get_inputs_factorid.Value##]" status="0" token=""
                                            result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.Status.Value##]' name="token" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                        <input type="hidden" value="[##db.get_inputs_totalfinal.Value##]"
                                            name="amount" />
                                        <!-- updated login -->
                                        <input type="hidden" value="" name="firstName" class="user-info-1" />
                                        <input type="hidden" value="" name="lastName" class="user-info-2" />
                                        <input type="hidden" value="" name="mobile" class="user-info-5" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount :
                                            </span><span><span
                                                    class="amount">[##db.get_inputs_totalfinal.Value##]</span>[##db.unit_title.Value##]</span>
                                        </div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking :
                                            </span><span>[##db.get_inputs_factorid.Value##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.Status.Value##]'='true'"><span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.Status.Value##]'<>'true'"><span
                                                    class="resulF">پرداخت
                                                    Unsuccessful</span></basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>
                        </basis>
                        <basis core="group" name="snapPayment" if="[##db.get_inputs_bank_id.Value##] = 98">
                            <basis core="inlinesource" name="db">
                                <member name="get_inputs_paymentToken" format="json"
                                    postsql="select  value  from [db.get_inputs_paymentToken] as a where Field = 'paymentToken'"
                                    preview="">{"root":[##db.get_inputs.result##]}</member>
                                <member name="get_inputs_authentication" format="json"
                                    postsql="select  value  from [db.get_inputs_authentication] as a where Field = 'authentication'"
                                    preview="">{"root":[##db.get_inputs.result##]}</member>
                            </basis>
                            <basis core="group" name="json">
                                <basis core="external.ws.ws" service="snapPayment" name="snap" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="true">
                                    <member name="m1" method="verify" sort="random">
                                        <params>
                                            <param name="payment_token"
                                                value="[##db.get_inputs_paymentToken.Value##]" />
                                            <param name="authentication"
                                                value="[##db.get_inputs_authentication.Value##]" />

                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="json">
                                    <basis core="inlinesource" name="db">
                                        <member name="Status" format="json"
                                            postsql="select  value  from [db.Status] as a where field = 'successful'"
                                            preview=""> {"root":[##snap.m1.result##]}</member>
                                    </basis>

                                    <basis core="group" if="'[##db.Status.Value##]'= 'true'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="28"
                                            invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##db.get_inputs_paymentToken.Value##]" status="1" token=""
                                            result="1">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <basis core="group" if="'[##db.Status.Value##]' <> 'true'">
                                        <basis core="dbsource" source="accounting" name="db" bankid="28"
                                            invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno=""
                                            hashedcardno="" merchantid=""
                                            paymentid="[##db.get_inputs_paymentid.Value##]"
                                            refnumber="[##db.get_inputs_paymentToken.Value##]" status="0" token=""
                                            result="0">
                                            <member name="updatepayment" type="scalar" request="updatepayment"
                                                preview="" />
                                        </basis>
                                        <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                    </basis>
                                    <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##db.Status.Value##]' name="token" />
                                        <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                        <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                            name="factortype" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                            name="paymentid" />
                                        <input type="hidden" value="[##db.get_inputs_totalfinal.Value##]"
                                            name="amount" />
                                        <!-- updated login -->
                                        <input type="hidden" value="" name="firstName" class="user-info-1" />
                                        <input type="hidden" value="" name="lastName" class="user-info-2" />
                                        <input type="hidden" value="" name="mobile" class="user-info-5" />
                                    </form>
                                    <div class="factor-info">
                                        <div class="factor-title"><span>Summary of transaction status :</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction amount :
                                            </span><span><span
                                                    class="amount">[##db.get_inputs_totalfinal.Value##]</span>[##db.unit_title.Value##]</span>
                                        </div>
                                        <div class="eachInfo"><span class="backq">Issue Tracking :
                                            </span><span>[##db.get_inputs_paymentid.Value##]</span></div>
                                        <div class="eachInfo"><span class="backq">Transaction status : </span>
                                            <basis core="group" if="'[##db.Status.Value##]'='true'"><span
                                                    class="resultT" id="resulTimeout">Successful</span></basis>
                                            <basis core="group" if="'[##db.Status.Value##]'<>'true'"><span
                                                    class="resulF">پرداخت Unsuccessful</span></basis>
                                        </div>
                                    </div>
                                </basis>
                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>
                            </basis>
                        </basis>
                        <basis core="group" name="vandarPayment" if="[##db.get_inputs_bank_id.Value##] = 96">
                            <basis core="inlinesource" name="db">
                                <member name="api_key" format="json"
                                    postsql="select value from [db.api_key] where field = 'api_key'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="vandar">
                                <basis core="external.ws.ws" service="vandarPayment" name="vandar" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="">
                                    <member name="m1" method="verify" sort="random" preview="">
                                        <params>
                                            <param name="api_key" value="[##db.api_key.Value##]" />
                                            <param name="token" value="[##cms.query.token##]" />
                                        </params>
                                    </member>
                                </basis>

                                <basis core="group" name="DelayPay">
                                    <basis core="inlinesource" name="db">
                                        <member name="status" format="json"
                                            postsql="select  Value  from [db.status] where field = 'status'" preview="">
                                            {"root":[##vandar.m1.result##]}</member>
                                        <member name="cardNumber" format="json"
                                            postsql="select  Value  from [db.cardNumber] where field = 'cardNumber'"
                                            preview="">
                                            {"root":[##vandar.m1.result##]}</member>
                                        <member name="transId" format="json"
                                            postsql="select  Value  from [db.transId] where field = 'transId'"
                                            preview="">
                                            {"root":[##vandar.m1.result##]}</member>
                                    </basis>
                                    <basis core="group" name="DelayvandarPayment2">

                                        <basis core="group" if="'[##db.status.Value##]' = 'true'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="26" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##db.cardNumber.Value##]" hashedcardno="" merchantid=""
                                                paymentid="[##db.get_inputs_paymentid.Value##]"
                                                refnumber="[##db.transId.Value##]" status="1" token="" result="1">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <basis core="group" if="'[##db.status.Value##]' <> 'true'">
                                            <basis core="dbsource" source="accounting" name="db" mid="43" lid="1"
                                                bankid="26" invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                                cardno="[##db.cardNumber.Value##]" hashedcardno="" merchantid=""
                                                paymentid="[##db.get_inputs_paymentid.Value##]"
                                                refnumber="[##db.transId.Value##]" status="0" token="" result="0">
                                                <member name="updatepayment" type="scalar" request="updatepayment"
                                                    preview="" />
                                            </basis>
                                            <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                        </basis>
                                        <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                            class="formbank">
                                            <input type="hidden" value='[##db.status.Value##]' name="token" />
                                            <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                            <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                            <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                                name="factorid" />
                                            <input type="hidden" value="[##db.get_inputs_agencyid.Value##]"
                                                name="agencyid" />
                                            <input type="hidden" value="[##db.get_inputs_supplier.Value##]"
                                                name="supplier" />
                                            <input type="hidden" value="[##db.get_inputs_paytype.Value##]"
                                                name="paytype" />
                                            <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                                name="trackingid" />
                                            <input type="hidden" value="[##db.get_inputs_bank_id.Value##]"
                                                name="bank_id" />
                                            <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                                name="factortype" />
                                            <input type="hidden" value="[##db.get_inputs_paymentid.Value##]"
                                                name="paymentid" />
                                        </form>
                                        <div class="factor-info">
                                            <div class="factor-title"><span>Summary of transaction status :</span></div>
                                            <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                                </span> [##db.transId.Value##]</div>
                                            <div class="eachInfo"><span class="backq">Transaction amount : </span>
                                                <span>
                                                    <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                                    Rial
                                                </span>
                                            </div>
                                            <div class="eachInfo"><span class="backq">Card number : </span> <span
                                                    style="display:inline-block; direction:ltr;">
                                                </span>[##db.cardNumber.Value##]</div>
                                            <div class="eachInfo"><span class="backq">Transaction status : </span>
                                                <basis core="group" if="'[##db.status.Value##]'='true'"> <span
                                                        class="resultT" id="resulTimeout">Successful</span></basis>
                                                <basis core="group" if="'[##db.status.Value##]'<>'true'"> <span
                                                        class="resulF">Unsuccessful</span>
                                                </basis>
                                            </div>
                                        </div>
                                    </basis>
                                </basis>
                            </basis>
                            <script type="text/javascript">
                                $(document).ready(function () {
                                    var url = "/Client_Final_Payment_en.bc";
                                    $.ajax({
                                        type: "POST",
                                        url: url,
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                });
                                $(".amount").text(function (index, value) {
                                    return value
                                        .replace(/\D/g, "")
                                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                });
                            </script>
                        </basis>
                        <basis core="group" name="PaypalPayment" if="[##db.get_inputs_bank_id.Value##] = 198">
                            <basis core="inlinesource" name="db">
                                <member name="get_inputs_order_id" format="json"
                                    postsql="select value from [db.get_inputs_order_id] where field = 'order_id'">
                                    {"root":[##db.get_inputs.result##]} </member>
                                <member name="get_inputs_unique_id" format="json"
                                    postsql="select value from [db.get_inputs_unique_id] where field = 'unique_id'">
                                    {"root":[##db.get_inputs.result##]} </member>
                                <member name="get_inputs_access_token" format="json"
                                    postsql="select value from [db.get_inputs_access_token] where field = 'access_token'">
                                    {"root":[##db.get_inputs.result##]} </member>
                            </basis>
                            <basis core="external.ws.ws" service="PaypalPayment" name="paypal" source="cmsDbService"
                                procedurename="sbserviceprocedure1" preview="true">
                                <member name="m1" method="verify" sort="random">
                                    <params>
                                        <param name="order_id" value="[##db.get_inputs_order_id.Value##]" />
                                        <param name="unique_id" value="[##db.get_inputs_unique_id.Value##]" />
                                        <param name="access_token" value="[##db.get_inputs_access_token.Value##]" />
                                    </params>
                                </member>
                            </basis>
                            <basis core="group" name="DelayPay">
                                <basis core="inlinesource" name="db">
                                    <member name="answer" format="json"
                                        postsql="select  Value  from [db.answer] where field = 'answer'">
                                        {"root":[##paypal.m1.result##]}</member>
                                    <member name="status" format="json"
                                        postsql="select  Value  from [db.status] where field = 'status' and path in ('.root.status')">
                                        {"root":[##db.answer.Value##]}</member>
                                </basis>
                                <basis core="group" if="'[##db.status.Value##]' = 'COMPLETED'">
                                    <basis core="dbsource" source="accounting" name="db" mid="43" lid="1" bankid="29"
                                        invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno="" hashedcardno=""
                                        merchantid="" paymentid="[##db.get_inputs_paymentid.Value##]"
                                        refnumber="[##db.get_inputs_order_id.Value##]" status="1" token="" result="1">
                                        <member name="updatepayment" type="scalar" request="updatepayment" preview="" />
                                    </basis>
                                    <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                </basis>
                                <basis core="group" if="'[##db.status.Value##]' <> 'COMPLETED'">
                                    <basis core="dbsource" source="accounting" name="db" mid="43" lid="1" bankid="29"
                                        invoicenumber="[##db.get_inputs_paymentid.Value##]" cardno="" hashedcardno=""
                                        merchantid="" paymentid="[##db.get_inputs_paymentid.Value##]"
                                        refnumber="[##db.get_inputs_order_id.Value##]" status="0" token="" result="0">
                                        <member name="updatepayment" type="scalar" request="updatepayment" preview="" />
                                    </basis>
                                    <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                </basis>
                                <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                    class="formbank">
                                    <input type="hidden" value='[##db.status.Value##]' name="token" />
                                    <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                    <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                    <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                    <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                    <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                    <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                    <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                        name="trackingid" />
                                    <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                    <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                        name="factortype" />
                                    <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                </form>
                                <div class="factor-info">
                                    <div class="factor-title"><span>Summary of transaction status :</span></div>
                                    <div class="eachInfo"><span class="backq">Issue Tracking : </span> <span>
                                        </span> [##db.get_inputs_order_id.Value##]</div>
                                    <div class="eachInfo"><span class="backq">Transaction amount : </span>
                                        <span>
                                            <span class="amount">[##db.get_inputs_totalfinal.Value##]</span>
                                            [##db.unit_title.Value##]
                                        </span>
                                    </div>
                                    <div class="eachInfo"><span class="backq">Transaction status : </span>
                                        <basis core="group" if="'[##db.status.Value##]'='COMPLETED'"> <span
                                                class="resultT" id="resulTimeout">Successful</span></basis>
                                        <basis core="group" if="'[##db.status.Value##]'<>'COMPLETED'"> <span
                                                class="resulF">Unsuccessful</span>
                                        </basis>
                                    </div>
                                </div>

                            </basis>
                            <script type="text/javascript">
                                $(document).ready(function () {
                                    var url = "/Client_Final_Payment_en.bc";
                                    $.ajax({
                                        type: "POST",
                                        url: url,
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                });
                                $(".amount").text(function (index, value) {
                                    return value
                                        .replace(/\D/g, "")
                                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                });
                            </script>

                        </basis>
                        <basis core="group" name="pod" if="[##db.get_inputs_bank_id.Value##] = 201">
                            <basis core="inlinesource" name="db">
                                <member name="token" format="json"
                                    postsql="select value from [db.token] where field = 'token'">
                                    {"root":[##db.webservice_detail.result##]} </member>
                            </basis>
                            <basis core="group" name="json">
                                <basis core="external.ws.ws" service="pod" name="pod" source="cmsDbService"
                                    procedurename="sbserviceprocedure1" preview="true">
                                    <member name="m1" method="verify" sort="random">
                                        <params>
                                            <param name="token" value="[##db.token.Value##]" />
                                            <param name="billNumber" value="[##cms.query.billNumber##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" if="'[##cms.query.paid##]'= 'True'">
                                    <basis core="dbsource" source="accounting" name="db" bankid="32"
                                        invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                        cardno="[##cms.query.maskedCardNumber##]" hashedcardno="" merchantid=""
                                        paymentid="[##db.get_inputs_paymentid.Value##]" refnumber="[##cms.query.rrn##]"
                                        status="1" token="" result="1">
                                        <member name="updatepayment" type="scalar" request="updatepayment" preview="" />
                                    </basis>
                                    <div class="updatepaymentT"> [##db.updatepayment.title##] </div>
                                </basis>
                                <basis core="group" if="'[##cms.query.paid##]' <> 'True'">
                                    <basis core="dbsource" source="accounting" name="db" bankid="32"
                                        invoicenumber="[##db.get_inputs_paymentid.Value##]"
                                        cardno="[##cms.query.maskedCardNumber##]" hashedcardno="" merchantid=""
                                        paymentid="[##db.get_inputs_paymentid.Value##]" refnumber="[##cms.query.rrn##]"
                                        status="0" token="" result="0">
                                        <member name="updatepayment" type="scalar" request="updatepayment" preview="" />
                                    </basis>
                                    <div class="updatepaymentF"> [##db.updatepayment.title##] </div>
                                </basis>
                                <form method="post" action="/Client_Final_Payment_en.bc" name="formbank"
                                    class="formbank">
                                    <input type="hidden" value='[##cms.query.paid##]' name="token" />
                                    <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                    <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                    <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                    <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                    <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                    <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                    <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                        name="trackingid" />
                                    <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                    <input type="hidden" value="[##db.get_inputs_factortype.Value##]"
                                        name="factortype" />
                                    <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                </form>
                                <div class="factor-info">
                                    <div class="factor-title"><span>Summary of transaction status :</span></div>
                                    <div class="eachInfo"><span class="backq">Transaction amount : </span><span><span
                                                class="amount">[##db.get_inputs_totalfinal.Value##]</span>[##db.unit_title.Value##]</span>
                                    </div>
                                    <div class="eachInfo"><span class="backq">Issue Tracking :
                                        </span><span>[##cms.query.rrn##]</span></div>
                                    <div class="eachInfo"><span class="backq">Card number :
                                        </span><span>[##cms.query.maskedCardNumber##]</span></div>
                                    <div class="eachInfo"><span class="backq">Transaction status : </span>
                                        <basis core="group" if="'[##cms.query.paid##]'='True'"><span class="resultT"
                                                id="resulTimeout">Successful</span></basis>
                                        <basis core="group" if="'[##cms.query.paid##]'<>'True'"><span
                                                class="resulF">Unsuccessful</span>
                                        </basis>
                                    </div>
                                </div>

                                <script type="text/javascript">
                                    $.ajax({
                                        type: "POST",
                                        url: "/Client_Final_Payment_en.bc",
                                        data: $(".formbank").serialize(),
                                        dataType: "html",
                                        success: function (response) {
                                            $(".sectionInfo").empty().html(response);
                                        }
                                    });
                                    $(".amount").text(function (index, value) {
                                        return value
                                            .replace(/\D/g, "")
                                            .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                    });
                                </script>


                            </basis>

                        </basis>
                        <basis core="group" name="credit_payment" if="[##cms.form.Credit_payment##] = 1">
                            <!-- payment by credit -->
                            <form method="post" action="/Client_Final_Payment_en.bc" name="formbank" class="formbank">
                                <input type="hidden" value="[##cms.form.Credit_payment##]" name="Credit_payment" />
                                <input type="hidden" value="[##db.checkrkey.userid|(0)##]" name="userid" />
                                <input type="hidden" value="[##cms.cms.domainid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_factortype.Value##]" name="factortype" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                            </form>
                            <script type="text/javascript">
                                $.ajax({
                                    type: "POST",
                                    url: "/Client_Final_Payment_en.bc",
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                    }
                                });

                            </script>

                        </basis>
                    </div>
                </div>
            </div>
            <basis core="call" file="Client_BasisCore_Script.inc"></basis><!-- updated login -->
            <script type="text/javascript">


                function onloadFunc() {
                    var counter = 150;
                    setInterval(function () {
                        counter--;
                        var m = parseInt(counter / 60);
                        var s = counter % 60;
                        if (counter >= 0) {
                            span = document.getElementById("counter");
                            if (s < 10) {
                                s = "0" + s;
                            }
                            if (m < 10) {
                                m = "0" + m;
                            }
                            if (m < 1) {
                                document.getElementById("counter").classList.add("blink_me")
                            }
                            span.innerHTML = "00:" + m + ":" + s;
                        }
                        if (counter === 0) {
                            window.location =
                                '[##site.address.domain##]/EN-Panel-Dashboard.bc?rK=[##db.get_inputs_rkey.Value##]'
                            clearInterval(counter);
                        }
                    }, 1000);

                };
                // updated login
                async function onProcessedUserinformation(args) {
                    const response = args.response;
                    const responseJson = await response.json();
                    if (!responseJson.errorMessage) {
                        if (responseJson.sources) {
                            const properties = responseJson.sources[0].data[0].properties;
                            properties?.forEach((e) => {
                                if (e.prpId == 1) {
                                    document.querySelector(".formbank").querySelectorAll(".user-info-1").forEach(e => {
                                        e.value = e.answers[0].parts[0].values[0].value
                                    })
                                    document.querySelector(".user-info-1").querySelector(".factor-answer").innerHTML = e.answers[0].parts[0].values[0].value;

                                } else if (e.prpId == 2) {
                                    document.querySelector(".formbank").querySelectorAll(".user-info-2").forEach(e => {
                                        e.value = e.answers[0].parts[0].values[0].value
                                    })
                                    document.querySelector(".user-info-2").querySelector(".factor-answer").innerHTML = e.answers[0].parts[0].values[0].value;
                                } else if (e.prpId == 3) {
                                    document.querySelector(".user-info-3").querySelector(".factor-answer").innerHTML = e.answers[0].parts[0].values[0].value;
                                } else if (e.prpId == 4) {
                                    document.querySelector(".user-info-4").querySelector(".factor-answer").innerHTML = e.answers[0].parts[0].values[0].value;
                                } else if (e.prpId == 5) {
                                    document.querySelector(".formbank").querySelectorAll(".user-info-5").forEach(e => {
                                        e.value = e.answers[0].parts[0].values[0].value
                                    })
                                    document.querySelector(".user-info-5").querySelector(".factor-answer").innerHTML = e.answers[0].parts[0].values[0].value;
                                } else if (e.prpId == 6) {
                                    document.querySelector(".user-info-6").querySelector(".factor-answer").innerHTML = e.answers[0].parts[0].values[0].value;
                                } else if (e.prpId == 7) {
                                    document.querySelector(".user-info-7").querySelector(".factor-answer").innerHTML = e.answers[0].parts[0].values[0].value;
                                } else if (e.prpId == 8) {
                                    document.querySelector(".user-info-8").querySelector(".factor-answer").innerHTML = e.answers[0].parts[0].values[0].value;
                                } else if (e.prpId == 9) {
                                    document.querySelector(".user-info-9").querySelector(".factor-answer").innerHTML = e.answers[0].parts[0].values[0].value;
                                }


                            });

                        }
                    }
                }
            </script>
        </body>

        </html>
    </basis>
</basis>