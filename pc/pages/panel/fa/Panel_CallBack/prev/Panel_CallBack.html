<basis core="dbsource" source="trust_login" mid="24" name="db" lid="1" ownerid="[##cms.cms.ownerid##]">
    <member name="dmnid" type="scalar" request="getdmnid" preview="" />
</basis>
<basis core="group" name="Delay_1">
    <basis core="external.fly.ws" source="cmsDbService2" procedurename="dbsource" name="db">
        <member name="get_inputs" method="cms" query='{
            "name": "db",
            "mid": "20",
            "member": [
                {
                    "request": "get_inputs",
                    "id": "[##cms.form.ResNum|cms.form.SaleOrderId|cms.query.iN|cms.query.Authority|cms.query.invoiceNumber|cms.form.payment_token|cms.form.OrderId|cms.form.transid|cms.form.traceNumber|cms.query.ResNum|cms.query.localInvoiceId|cms.form.requestId|cms.query.invoiceId##]"
                }
            ]
        }' preview="" />
    </basis>
    <basis core="group" name="Delay_2">
        <basis core="inlinesource" name="db">
            <member name="get_inputs_id" format="json"
                postsql="select  value  from [db.get_inputs_id] as a where Field = 'id'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_trackingid" format="json"
                postsql="select  value  from [db.get_inputs_trackingid] as a where Field = 'trackingid'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_rkey" format="json"
                postsql="select  value  from [db.get_inputs_rkey] as a where Field = 'rkey'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_factorid" format="json"
                postsql="select  value  from [db.get_inputs_factorid] as a where Field = 'factorid'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_agencyid" format="json"
                postsql="select  value  from [db.get_inputs_agencyid] as a where Field = 'agencyid'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_paytype" format="json"
                postsql="select  value  from [db.get_inputs_paytype] as a where Field = 'paytype'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_totalfinal" format="json"
                postsql="select  value  from [db.get_inputs_totalfinal] as a where Field = 'totalfinal'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_supplier" format="json"
                postsql="select  value  from [db.get_inputs_supplier] as a where Field = 'supplier'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_bank_id" format="json"
                postsql="select  value  from [db.get_inputs_bank_id] as a where Field = 'bank_id'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_bankid" format="json"
                postsql="select  value  from [db.get_inputs_bankid] as a where Field = 'bankid'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
            <member name="get_inputs_paymentid" format="json"
                postsql="select  value  from [db.get_inputs_paymentid] as a where Field = 'paymentid'" preview="">
                {"root":[##db.get_inputs.result##]}</member>
        </basis>
        <basis core="dbsource" source="hosting" name="site">
            <member name="address" type="list" request="siteaddress" />
        </basis>
        <basis core="dbsource" source="trust_login8" name="db" mid="24" lid="1" rkey="[##db.get_inputs_rkey.Value##]">
            <member name="userid" request="userid" type="scalar" preview="" />
        </basis>
        <basis core="dbsource" source="trust_login8" mid="24" name="db" lid="1" request="information"
            rkey="[##db.get_inputs_rkey.Value##]">
            <member name="userinfo" type="view" preview="" />
        </basis>
        <basis core="external.fly.ws" source="cmsDbService2" name="db" procedurename="dbsource">
            <member name="webservice_detail" method="cms" query='
    { 
        "name": "db",
        "mid": "20",
        "member":
        [
            { 
                "name": "q", 
                "type":"list",
                "request": "webservice_Detail",
                "id": "[##db.get_inputs_bank_id.Value##]"
            }
        ] 
    } ' />
        </basis>

        <html>

        <head>
            <meta name="description" content="Waiting" />
            <meta name="author" content="BasisCore">
            <meta charset="utf-8">
            <title>Waiting</title>
            <script src="https://cdn.basiscore.net/basisfly.com/js/reservation_js_library.js" type="text/javascript">
            </script>
            <basis core="call" file="Panel_Loading_Css.inc" />
        </head>

        <body>
            <div id="alert-Loadding-box"></div>
            <div id="alert-Loadding">
                <div class="sectionInfo">
                    <div id="circularG">
                        <div id="circularG_1" class="circularG"></div>
                        <div id="circularG_2" class="circularG"></div>
                        <div id="circularG_3" class="circularG"></div>
                        <div id="circularG_4" class="circularG"></div>
                        <div id="circularG_5" class="circularG"></div>
                        <div id="circularG_6" class="circularG"></div>
                        <div id="circularG_7" class="circularG"></div>
                        <div id="circularG_8" class="circularG"></div>
                    </div>
                </div>
                <basis core="group" name="Saman" if="[##db.get_inputs_bank_id.Value##] = 31">
                    <basis core="group" name="samanll">
                        <basis core="external.ws.ws" service="saman" name="saman" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="">
                            <member name="m1" method="verifyTransaction" sort="random">
                                <params>
                                    <param name="RefNum" value="[##cms.form.RefNum##]" />
                                    <param name="MID" value="[##cms.form.MID##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##saman.m1.result##]' id="json" name="token" />
                                <input type="hidden" value="" id="action" name="action" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.value##]" name="paytype" />
                                <input type="hidden" value="[##cms.form.ResNum##]" name="ResNum" />
                                <input type="hidden" value="[##cms.form.SecurePan##]" name="SecurePan" />
                                <input type="hidden" value="[##cms.form.CID##]" name="CID" />
                                <input type="hidden" value="[##cms.form.MID##]" name="MID" />
                                <input type="hidden" value="[##cms.form.RRN##]" name="RRN" />
                                <input type="hidden" value="[##cms.form.TRACENO##]" name="TRACENO" />
                                <input type="hidden" value="[##cms.form.StateCode##]" name="StateCode" />
                                <input type="hidden" value="[##cms.form.RefNum##]" name="RefNum" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                            </form>
                            <basis core="group" if="'[##cms.form.StateCode##]'='0'">

                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>

                            <basis core="group" if="'[##cms.form.StateCode##]'='14'">
                                <div class="alert-Txt">پرداخت ناموفق (شماره کارت نامعتبر است.)</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>

                            <basis core="group" if="'[##cms.form.StateCode##]'='51'">
                                <div class="alert-Txt">پرداخت ناموفق(موجودي کافی نیست.)</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>

                            <basis core="group" if="'[##cms.form.StateCode##]'='55'">
                                <div class="alert-Txt">پرداخت ناموفق(رمز نادرست است)</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>

                            <basis core="group" if="'[##cms.form.StateCode##]'='38'">
                                <div class="alert-Txt">پرداخت ناموفق(تعداد دفعات وارد کردن رمز بیش از حد مجاز است)</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>

                            <basis core="group" if="'[##cms.form.StateCode##]'='14'">
                                <div class="alert-Txt">پرداخت ناموفق(شماره کارت نامعتبر است.)</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>

                            <basis core="group" if="'[##cms.form.StateCode##]'='33'">
                                <div class="alert-Txt">پرداخت ناموفق(تاریخ اعتبار گذشته است و کارت نامعتبر است.)</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>

                            <basis core="group" if="'[##cms.form.StateCode##]'='-1'">
                                <div class="alert-Txt">پرداخت ناموفق(کاربر از انجام تراکش منصرف شده است.)</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>

                            <basis core="group" if="'[##cms.form.StateCode##]'='96'">
                                <div class="alert-Txt">پرداخت ناموفق(خطاهای بانکی)</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                        </basis>
                    </basis>

                    <script type="text/javascript">
                        var str = document.getElementById("json").value;
                        str = str.replace(/"/g, ' ');
                        if (str == 'Time Out') {
                            document.getElementById("action").value = 0;
                            document.getElementById("resulTimeout").innerHTML = 'ناموفق';
                            document.getElementById("resulTimeout").classList.add("resulF");
                            document.getElementById("resulTimeout").classList.remove("resultT");

                        }
                        else {
                            document.getElementById("action").value = 1;
                        }
                        // $(window).load(function() {

                        var url = "/Panel_Final_Payment.bc";
                        $.ajax({
                            type: "POST",
                            url: url,
                            data: $(".formbank").serialize(),
                            dataType: "html",
                            success: function (response) {
                                $(".sectionInfo").empty().html(response);
                                window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                            }
                        });
                        // });
                    </script>


                </basis>
                <basis core="group" name="Mellat" if="[##db.get_inputs_bank_id.Value##] = 32">
                    <basis core="inlinesource" name="db">
                        <member name="terminalid" format="json"
                            postsql="select value from [db.terminalid] where field = 'terminalid'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="username" format="json"
                            postsql="select value from [db.username] where field = 'username'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="password" format="json"
                            postsql="select value from [db.password] where field = 'password'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="Mellatall">
                        <basis core="external.ws.ws" service="mellat" name="mellat" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="">
                            <member name="m1" method="bpVerifyRequest" sort="random">
                                <params>
                                    <param name="TerminalId" value="[##db.terminalid.Value##]" />
                                    <param name="userName" value="[##db.username.Value##]" />
                                    <param name="userPassword" value="[##db.password.Value##]" />
                                    <param name="orderId" value="[##cms.form.SaleOrderId##]" />
                                    <param name="saleOrderId" value="[##cms.form.SaleOrderId##]" />
                                    <param name="saleReferenceId" value="[##cms.form.SaleReferenceId##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="MellatallDealy">
                            <basis core="external.ws.ws" service="mellat" name="mellat2" source="cmsDbService"
                                procedurename="sbserviceprocedure1" preview="">
                                <member name="m2" method="bpSettleRequest" sort="random">
                                    <params>
                                        <param name="TerminalId" value="[##db.terminalid.Value##]" />
                                        <param name="userName" value="[##db.username.Value##]" />
                                        <param name="userPassword" value="[##db.password.Value##]" />
                                        <param name="orderId" value="[##cms.form.SaleOrderId##]" />
                                        <param name="saleOrderId" value="[##cms.form.SaleOrderId##]" />
                                        <param name="saleReferenceId" value="[##cms.form.SaleReferenceId##]" />
                                    </params>
                                </member>
                            </basis>
                            <basis core="group" name="json">
                                <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                    <input type="hidden" value='[##mellat.m1.result##]' id="json" name="token" />
                                    <input type="hidden" value="" id="action" name="action" />
                                    <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                    <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                    <input type="hidden" value="[##db.get_inputs_agencyid.value##]" name="agencyid" />
                                    <input type="hidden" value="[##db.get_inputs_supplier.value##]" name="supplier" />
                                    <input type="hidden" value="[##db.get_inputs_paytype.value##]" name="paytype" />
                                    <input type="hidden" value="[##cms.form.SaleOrderId##]" name="SaleOrderId" />
                                    <input type="hidden" value="[##cms.form.CardHolderPan##]" name="CardHolderPan" />
                                    <input type="hidden" value="[##cms.form.CardHolderInfo##]" name="CardHolderInfo" />
                                    <input type="hidden" value="[##cms.form.SaleReferenceId##]"
                                        name="SaleReferenceId" />
                                    <input type="hidden" value="[##cms.form.ResCode##]" name="ResCode" />
                                    <input type="hidden" value="[##cms.form.RefId##]" name="RefId" />
                                    <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                    <input type="hidden" value="[##db.get_inputs_paymentid.value##]" name="paymentid" />
                                    <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                        name="trackingid" />
                                </form>

                                <basis core="group" if="'[##cms.form.ResCode##]'='0'">
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##cms.form.ResCode##]'='11'">
                                    <div class="alert-Txt">پرداخت ناموفق(شماره کارت نامعتبر است.)</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##cms.form.ResCode##]'='12'">
                                    <div class="alert-Txt">پرداخت ناموفق(موجودي کافی نیست.)</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##cms.form.ResCode##]'='13'">
                                    <div class="alert-Txt">پرداخت ناموفق(رمز نادرست است)</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##cms.form.ResCode##]'='14'">
                                    <div class="alert-Txt">پرداخت ناموفق(تعداد دفعات وارد کردن رمز بیش از حد مجاز است)
                                    </div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##cms.form.ResCode##]'='15'">
                                    <div class="alert-Txt">پرداخت ناموفق(کارت نامعتبر است.)</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##cms.form.ResCode##]'='16'">
                                    <div class="alert-Txt">پرداخت ناموفق(دفعات برداشت وجه بیش از حد مجاز است.)</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##cms.form.ResCode##]'='17'">
                                    <div class="alert-Txt">پرداخت ناموفق(کاربر از انجام تراکش منصرف شده است.)</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##cms.form.ResCode##]'='18'">
                                    <div class="alert-Txt">پرداخت ناموفق(تاریخ انقضا کارت گذشته است.)</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##cms.form.ResCode##]'='19'">
                                    <div class="alert-Txt">پرداخت ناموفق(مبلغ برداشت وجه بیش از حد مجاز است.)</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##cms.form.ResCode##]'='51'">
                                    <div class="alert-Txt">پرداخت ناموفق(تراکنش تکراری است)</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group"
                                    if="[##cms.form.ResCode##] not in (0,11,12,13,14,15,16,17,18,19,51)">
                                    <div class="alert-Txt">پرداخت ناموفق است</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                            </basis>
                        </basis>
                    </basis>

                    <script type="text/javascript">
                        var str = document.getElementById("json").value;
                        str = str.replace(/"/g, ' ');
                        if (str == 'Time Out') {
                            document.getElementById("action").value = 0;
                            document.getElementById("resulTimeout").innerHTML = 'ناموفق';
                            document.getElementById("resulTimeout").classList.add("resulF");
                            document.getElementById("resulTimeout").classList.remove("resultT");

                        }
                        else {
                            document.getElementById("action").value = 1;
                        }
                        // $(window).load(function() {
                        var url = "/Panel_Final_Payment.bc";
                        $.ajax({
                            type: "POST",
                            url: url,
                            data: $(".formbank").serialize(),
                            dataType: "html",
                            success: function (response) {
                                $(".sectionInfo").empty().html(response);
                                window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                            }
                        });
                        // });
                    </script>


                </basis>
                <basis core="group" name="Psargad" if="[##db.get_inputs_bank_id.Value##] = 33">
                    <basis core="inlinesource" name="db">
                        <member name="merchantID" format="json"
                            postsql="select value from [db.merchantID] where field = 'merchantid'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="terminalID" format="json"
                            postsql="select value from [db.terminalID] where field = 'terminalid'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="Vdelay">
                        <basis core="external.ws.ws" service="pasargadBank" name="pasargad" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="">
                            <member name="m1" method="pasargadCheckTransaction" merchantCode="[##db.merchantID.Value##]"
                                sort="random">
                                <params>
                                    <param name="tref" value="[##cms.query.tref##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="delay">
                            <basis core="inlinesource" name="db">
                                <member name="check" format="json" preview="">{"root":[##pasargad.m1.result##]}</member>
                                <member name="traceNumber" format="json"
                                    postsql="select value from [db.traceNumber] where field = 'traceNumber'" preview="">
                                    {"root":[##pasargad.m1.result##]}</member>
                                <member name="result" format="json"
                                    postsql="select value from [db.result] where field = 'result'" preview="">
                                    {"root":[##pasargad.m1.result##]}</member>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="verify" class="verify formbank">
                                <input type="hidden" value='[##pasargad.m1.result##]' id="json" name="token" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="" id="action" name="action" />
                                <basis core="print" datamembername="db.check">
                                    <face filter="field='result'">
                                        <input type="hidden" name="result" value="@value">
                                    </face>
                                    <face filter="field='transactionReferenceID'">
                                        <input type="hidden" name="ReferenceID" value="@value">
                                    </face>
                                    <face filter="field='invoiceDate'">
                                        <input type="hidden" name="invoiceDate" value="@value">
                                    </face>
                                    <face filter="field='invoiceNumber'">
                                        <input type="hidden" name="invoiceNumber" value="@value">
                                    </face>
                                    <face filter="field='amount'">
                                        <input type="hidden" name="amount" value="@value">
                                    </face>
                                    <face filter="field='traceNumber'">
                                        <input type="hidden" name="traceNumber" value="@value">
                                    </face>
                                    <face filter="field='referenceNumber'">
                                        <input type="hidden" name="referenceNumber" value="@value">
                                    </face>
                                    <face filter="field='transactionDate'">
                                        <input type="hidden" name="transactionDate" value="@value">
                                    </face>
                                </basis>

                                <input type="hidden" value="[##db.get_inputs_agencyid.value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.value##]" name="paytype" />
                                <input type="hidden" value="[##cms.form.SaleOrderId##]" name="SaleOrderId" />
                                <input type="hidden" value="[##cms.form.CardHolderPan##]" name="CardHolderPan" />
                                <input type="hidden" value="[##cms.form.CardHolderInfo##]" name="CardHolderInfo" />
                                <input type="hidden" value="[##cms.form.SaleReferenceId##]" name="SaleReferenceId" />
                                <input type="hidden" value="[##cms.form.ResCode##]" name="ResCode" />
                                <input type="hidden" value="[##cms.form.RefId##]" name="RefId" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.merchantID.Value##]" name="merchantID" />
                                <input type="hidden" value="[##db.terminalID.Value##]" name="terminalID" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.value##]" name="paymentid" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <!--     <input type="submit" value="verify"/>   -->
                            </form>

                        </basis>

                        <script type="text/javascript">
                            var str = document.getElementById("json").value;
                            str = str.replace(/"/g, ' ');
                            if (str == 'Time Out') {
                                document.getElementById("action").value = 0;
                                document.getElementById("resulTimeout").innerHTML = 'ناموفق';
                                document.getElementById("resulTimeout").classList.add("resulF");
                                document.getElementById("resulTimeout").classList.remove("resultT");

                            }
                            else {
                                document.getElementById("action").value = 1;
                            }
                            // $(window).load(function() {
                            var url = "/Panel_Final_Payment.bc";
                            $.ajax({
                                type: "POST",
                                url: url,
                                data: $(".formbank").serialize(),
                                dataType: "html",
                                success: function (response) {
                                    $(".sectionInfo").empty().html(response);
                                    window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                }
                            });
                            // });
                        </script>

                    </basis>
                </basis>
                <basis core="group" name="Pay" if="[##db.get_inputs_bank_id.Value##] = 34">
                    <basis core="inlinesource" name="db">
                        <member name="api" format="json" postsql="select value from [db.api] where field = 'api'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="Pay">
                        <basis core="external.ws.ws" service="pay" name="pay" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="">
                            <member name="m1" method="verify" sort="random">
                                <params>
                                    <param name="api" value="[##db.api.Value##]" />
                                    <param name="token" value="[##cms.query.token##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="DealyPay">
                            <basis core="inlinesource" name="db">
                                <member name="status" format="json"
                                    postsql="select  Value  from [db.status] where field = 'status'" preview="">
                                    {"root":[##pay.m1.result##]}</member>
                                <member name="amount" format="json"
                                    postsql="select  Value  from [db.amount] where field = 'amount'" preview="">
                                    {"root":[##pay.m1.result##]}</member>
                                <member name="transId" format="json"
                                    postsql="select  Value  from [db.transId] where field = 'transId'" preview="">
                                    {"root":[##pay.m1.result##]}</member>
                                <member name="cardNumber" format="json"
                                    postsql="select  Value  from [db.cardNumber] where field = 'cardNumber'" preview="">
                                    {"root":[##pay.m1.result##]}</member>
                                <member name="factorNumber" format="json"
                                    postsql="select  Value  from [db.factorNumber] where field = 'factorNumber'"
                                    preview="">{"root":[##pay.m1.result##]}</member>
                            </basis>
                            <basis core="group" name="DealyPay2">
                                <basis core="group" if="'[##db.Status.value##]' = 'false'">
                                    <basis core="inlinesource" name="db">
                                        <member name="errorMessage" format="json"
                                            postsql="select  Value  from [db.errorMessage] where field = 'errorMessage'"
                                            preview="">{"root":[##pay.m1.result##]}</member>
                                    </basis>
                                </basis>
                                <basis core="group" name="json">
                                    <form method="post" action="/Panel_Final_Payment.bc" name="formbank"
                                        class="formbank">
                                        <input type="hidden" value='[##pay.m1.result##]' id="json" />
                                        <input type="hidden" value="" id="action" name="action" />
                                        <input type="hidden" value='[##db.status.Value##]' name="status" />
                                        <input type="hidden" value='[##cms.query.status##]' name="urlstatus" />
                                        <input type="hidden" value='[##cms.query.token##]' name="token" />
                                        <input type="hidden" value='[##db.amount.Value##]' name="amount" />
                                        <input type="hidden" value='[##db.transId.Value##]' name="transId" />
                                        <input type="hidden" value='[##db.cardNumber.Value##]' name="cardNumber" />
                                        <input type="hidden" value='[##db.factorNumber.Value##]' name="factorNumber" />
                                        <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                        <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                            name="factorid" />
                                        <input type="hidden" value="[##db.get_inputs_agencyid.value##]"
                                            name="agencyid" />
                                        <input type="hidden" value="[##db.get_inputs_supplier.value##]"
                                            name="supplier" />
                                        <input type="hidden" value="[##db.get_inputs_paytype.value##]" name="paytype" />
                                        <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                        <input type="hidden" value="[##db.get_inputs_paymentid.value##]"
                                            name="paymentid" />
                                        <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                            name="trackingid" />

                                    </form>
                                    <basis core="group" if="'[##db.status.Value##]'='true'">
                                        <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                    </basis>
                                    <basis core="group" if="'[##db.status.Value##]'='false'">
                                        <div class="alert-Txt">پرداخت ناموفق است</div>
                                        <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                    </basis>
                                    <basis core="group" if="'[##db.status.Value##]'='false'">
                                        <div class="alert-Txt">[##db.errorMessage.Value##]</div>
                                        <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                    </basis>
                                </basis>
                            </basis>
                        </basis>
                    </basis>

                    <script type="text/javascript">
                        var str = document.getElementById("json").value;
                        str = str.replace(/"/g, ' ');
                        if (str == 'Time Out') {
                            document.getElementById("action").value = 0;
                            document.getElementById("resulTimeout").innerHTML = 'ناموفق';
                            document.getElementById("resulTimeout").classList.add("resulF");
                            document.getElementById("resulTimeout").classList.remove("resultT");

                        }
                        else {
                            document.getElementById("action").value = 1;
                        }
                        // $(window).load(function(){
                        var url = "/Panel_Final_Payment.bc";
                        $.ajax({
                            type: "POST",
                            url: url,
                            data: $(".formbank").serialize(),
                            dataType: "html",
                            success: function (response) {
                                $(".sectionInfo").empty().html(response);
                                window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                            }
                        });
                        // });
                    </script>


                </basis>
                <basis core="group" name="zarrinpal" if="[##db.get_inputs_bank_id.Value##] = 35">
                    <basis core="inlinesource" name="db">
                        <member name="merchantID" format="json" preview=""
                            postsql="select value from [db.merchantID] where field = 'merchantid'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="json">
                        <basis core="external.ws.ws" service="zarrinPal" name="zarrinPal_verify" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="">
                            <member name="m1" method="PaymentVerification" sort="random" preview="">
                                <params>
                                    <param name="MerchantID" value="[##db.merchantID.Value##]" />
                                    <param name="Authority" value="[##cms.query.Authority##]" />
                                    <param name="Amount" value="[##db.get_inputs_totalfinal.Value##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="Status" format="json"
                                    postsql="select  value  from [db.Status] as a where field = 'Status'" preview="">
                                    {"root":[##zarrinPal_verify.m1.result##]}</member>
                                <member name="RefID" format="json"
                                    postsql="select  value  from [db.RefID] as a where field = 'RefID'" preview="">
                                    {"root":[##zarrinPal_verify.m1.result##]}</member>
                            </basis>
                            <basis core="group" name="json">
                                <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                    <input type="hidden" value='[##db.Status.Value##]' name="token" />
                                    <input type="hidden" value="[##db.RefID.Value##]" name="RefID" />
                                    <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                    <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                    <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                    <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                    <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                    <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                    <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                    <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                        name="trackingid" />
                                    <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                </form>
                                <basis core="group" if="'[##db.Status.Value##]'= '100'">
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##db.Status.Value##]' <> '100'">
                                    <div class="alert-Txt">پرداخت ناموفق است</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                            </basis>
                            <script type="text/javascript">
                                //   $(window).load(function() {
                                var url = "/Panel_Final_Payment.bc";
                                $.ajax({
                                    type: "POST",
                                    url: url,
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                        window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                    }
                                });
                                // });
                            </script>

                        </basis>
                    </basis>
                </basis>
                <basis core="group" name="Asanpardakht" if="[##db.get_inputs_bank_id.Value##] = 38">
                    <basis core="inlinesource" name="db">
                        <member name="merchantID" format="json"
                            postsql="select value from [db.merchantID] where field = 'merchantid'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="username" format="json"
                            postsql="select value from [db.username] where field = 'username'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="password" format="json"
                            postsql="select value from [db.password] where field = 'password'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="easypay">
                        <basis core="external.ws.ws" service="easyPayment" name="asanPardakht" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="">
                            <member name="m1" method="DecryptData" sort="random" preview="">
                                <params>
                                    <param name="SSLid" value="13" />
                                    <param name="ReturningParams" value="[##cms.form.ReturningParams##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="vrf1">
                            <basis core="inlinesource" name="db">
                                <member name="PayGateTranID" format="json" preview=""
                                    postsql="select Value from [db.PayGateTranID] where Field = 'PayGateTranID'">
                                    {"root":[##asanPardakht.m1.result##]} </member>
                                <member name="Form-Tree" format="json"> {"root":[##asanPardakht.m1.result##]} </member>
                            </basis>
                            <basis core="group" name="vrf2">
                                <basis core="external.ws.ws" service="easyPayment" name="asanPardakht"
                                    source="cmsDbService" procedurename="sbserviceprocedure1" preview="">
                                    <member name="verify1" method="RequestVerification" sort="random" preview="">
                                        <params>
                                            <param name="SSLid" value="13" />
                                            <param name="merchantConfigurationID" value="[##db.merchantID.Value##]" />
                                            <param name="payGateTranID " value="[##db.PayGateTranID.Value##]" />
                                            <param name="userName" value="[##db.username.Value##]" />
                                            <param name="password" value="[##db.password.Value##]" />
                                        </params>
                                    </member>
                                </basis>
                                <basis core="group" name="vrf3">
                                    <basis core="inlinesource" name="db">
                                        <member name="verify1-Tree" format="json" preview=""
                                            postsql="select Value from [db.verify1-Tree] where Field = 'asanPardakht_verify1'">
                                            {"root":[##asanPardakht.verify1.result##]}
                                        </member>
                                    </basis>
                                    <basis core="group" if="'[##db.verify1-Tree.Value##]' = '500'">
                                        <basis core="external.ws.ws" service="easyPayment" name="asanPardakht"
                                            source="cmsDbService" procedurename="sbserviceprocedure1" preview="">
                                            <member name="verify2" method="RequestReconciliation" sort="random"
                                                preview="">
                                                <params>
                                                    <param name="SSLid" value="13" />
                                                    <param name="merchantConfigurationID"
                                                        value="[##db.merchantID.Value##]" />
                                                    <param name="payGateTranID " value="[##db.PayGateTranID.Value##]" />
                                                    <param name="userName" value="[##db.username.Value##]" />
                                                    <param name="password" value="[##db.password.Value##]" />
                                                </params>
                                            </member>
                                        </basis>
                                        <basis core="group" name="vrf4">
                                            <basis core="inlinesource" name="db">
                                                <member name="verify2-Tree" format="json" preview=""
                                                    postsql="select Value from [db.verify2-Tree] where Field = 'asanPardakht_verify2'">
                                                    {"root":[##asanPardakht.verify2.result##]}
                                                </member>
                                            </basis>
                                            <basis core="group" name="json">
                                                <form method="post" action="/Panel_Final_Payment.bc" name="formbank"
                                                    class="formbank">
                                                    <input type="hidden" value="" id="action" name="action" />
                                                    <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                                    <input type="hidden" value="[##db.get_inputs_paymentid.value##]"
                                                        name="paymentid" />
                                                    <input type="hidden" value="[##db.get_inputs_factorid.Value##]"
                                                        name="factorid" />
                                                    <input type="hidden" value="[##db.get_inputs_agencyid.value##]"
                                                        name="agencyid" />
                                                    <input type="hidden" value="[##db.get_inputs_supplier.value##]"
                                                        name="supplier" />
                                                    <input type="hidden" value="[##db.get_inputs_paytype.value##]"
                                                        name="paytype" />
                                                    <input type="hidden" value="[##db.get_inputs_bank_id.Value##]"
                                                        name="bank_id" />
                                                    <input type="hidden" value="[##db.merchantID.Value##]"
                                                        name="merchantID" />
                                                    <input type="hidden" value="[##db.verify2-Tree.Value##]"
                                                        name="verifytoken" />
                                                    <input type="hidden" value="[##db.get_inputs_trackingid.Value##]"
                                                        name="trackingid" />
                                                    <basis core="print" datamembername="db.Form-Tree">
                                                        <face filter="Field = 'RefID'">
                                                            <input type="hidden" value="@value" name="RefID">
                                                        </face>
                                                        <face filter="Field = 'ResCode'">
                                                            <input type="hidden" value="@value" name="ResCode">
                                                            <input type="hidden" value='@value' id="json"
                                                                name="token" />
                                                        </face>
                                                        <face filter="Field = 'PayGateTranID'">
                                                            <input type="hidden" value="@value" name="PayGateTranID">
                                                        </face>
                                                        <face filter="Field = 'RRN'">
                                                            <input type="hidden" value="@value" name="RRN">
                                                        </face>
                                                        <face filter="Field = 'SalesOrderId '">
                                                            <input type="hidden" value="@value" name="SalesOrderId ">
                                                        </face>
                                                        <face filter="Field = 'FirstSixDigitOfPAN '">
                                                            <input type="hidden" value="@value"
                                                                name="FirstSixDigitOfPAN ">
                                                        </face>
                                                        <face filter="Field = 'LastFourDigitOfPAN '">
                                                            <input type="hidden" value="@value"
                                                                name="LastFourDigitOfPAN ">
                                                        </face>
                                                    </basis>
                                                </form>
                                                <basis core="print" datamembername="db.Form-Tree">
                                                    <face filter="Field = 'ResCode' and value in ('00','0')">
                                                        <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید
                                                        </div>
                                                    </face>
                                                    <face filter="Field = 'ResCode' and value not in ('00','0')">
                                                        <div class="alert-Txt">پرداخت ناموفق است</div>
                                                        <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید
                                                        </div>
                                                    </face>
                                                </basis>
                                            </basis>
                                        </basis>
                                    </basis>
                                    <basis core="group" if="'[##db.verify1-Tree.Value##]' <> '500'">
                                        <div class="alert-Txt">پرداخت ناموفق است</div>
                                        <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                    </basis>
                                </basis>
                            </basis>
                        </basis>
                    </basis>


                    <script type="text/javascript">

                        var str = document.getElementById("json").value;
                        str = str.replace(/"/g, ' ');
                        if (str == 'Time Out') {
                            document.getElementById("action").value = 0;
                            document.getElementById("resulTimeout").innerHTML = 'ناموفق';
                            document.getElementById("resulTimeout").classList.add("resulF");
                            document.getElementById("resulTimeout").classList.remove("resultT");

                        }
                        else {
                            document.getElementById("action").value = 1;
                        }
                        // $(window).load(function() {
                        var url = "/Panel_Final_Payment.bc";
                        $.ajax({
                            type: "POST",
                            url: url,
                            data: $(".formbank").serialize(),
                            dataType: "html",
                            success: function (response) {
                                $(".sectionInfo").empty().html(response);
                                window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                            }
                        });
                        // });
                    </script>


                </basis>
                <basis core="group" name="Sekhavat" if="[##db.get_inputs_bank_id.Value##] = 39">
                    <basis core="group" name="sekhavatll">
                        <basis core="external.ws.ws" service="sekhavat" name="sekhavat" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="">
                            <member name="m1" method="sale" sort="random">
                                <params>
                                    <param name="SSLid" value="12" />
                                    <param name="vendorId" value="PSekhTick2016" />
                                    <param name="vendorPass" value="O5rt8Eku7" />
                                    <param name="TerminalId" value="bmi035" />
                                    <param name="TerminalPass" value="9725" />
                                    <param name="merchantId" value="27035" />
                                    <param name="merchantReference" value="[##cms.form.merchantReference##]" />
                                    <param name="merchantDate" value="[##cms.form.merchantDate##]" />
                                    <param name="merchantTime" value="[##cms.form.merchantTime##]" />
                                    <param name="cardNum" value="[##cms.form.cardNum##]" />
                                    <param name="cardType" value="[##cms.form.cardType##]" />
                                    <param name="securityCode" value="[##cms.form.securityCode##]" />
                                    <param name="expYear" value="[##cms.form.expYear##]" />
                                    <param name="expMonth" value="[##cms.form.expMonth##]" />
                                    <param name="cardHolderIp" value="[##cms.form.cardHolderIp##]" />
                                    <param name="dutyAmount" value="[##cms.form.dutyAmount##]" />
                                    <param name="shippingAmount" value="[##cms.form.shippingAmount##]" />
                                    <param name="taxAmount" value="[##cms.form.taxAmount##]" />
                                    <param name="purchaseAmount" value="[##cms.form.purchaseAmount##]" />
                                    <param name="totalAmount" value="[##cms.form.totalAmount##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##sekhavat.m1.result##]' id="json" name="token" />
                                <input type="hidden" value="" id="action" name="action" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.value##]" name="paymentid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" name="merchantReference" value="[##cms.form.merchantReference##]">
                                <input type="hidden" value="[##db.get_inputs_agencyid.value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" class="cardNum1" value="[##cms.form.cardNum##]" name="cardNum1" />
                                <input type="hidden" class="cardNum2" value="[##cms.form.cardNum##]" name="cardNum2" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />

                            </form>

                            <basis core="group" name="g1">
                                <basis core="inlinesource" name="db1">
                                    <member name="mskh" format="json"
                                        postsql="select  value  from [db1.mskh] as a where Field = 'Status'" preview="">
                                        {"root":[##sekhavat.m1.result##]}</member>
                                </basis>
                                <basis core="group" if="'[##db1.mskh.Value##]'='ok'">
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                                <basis core="group" if="'[##db1.mskh.Value##]'='error'">
                                    <div class="alert-Txt">پرداخت ناموفق است</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>
                            </basis>
                        </basis>
                    </basis>


                    <script type="text/javascript">
                        var str = document.getElementById("json").value;
                        str = str.replace(/"/g, ' ');
                        if (str == 'Time Out') {
                            document.getElementById("action").value = 0;
                            document.getElementById("resulTimeout").innerHTML = 'ناموفق';
                            document.getElementById("resulTimeout").classList.add("resulF");
                            document.getElementById("resulTimeout").classList.remove("resultT");

                        }
                        else {
                            document.getElementById("action").value = 1;
                        }
                        // $(window).load(function(){
                        var url = "/Panel_Final_Payment.bc";
                        $.ajax({
                            type: "POST",
                            url: url,
                            data: $(".formbank").serialize(),
                            dataType: "html",
                            success: function (response) {
                                $(".sectionInfo").empty().html(response);
                                window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                            }
                        });
                        // });
                    </script>


                </basis>
                <basis core="group" name="Gardeshgari" if="[##db.get_inputs_bank_id.Value##] = 50">
                    <basis core="external.ws.ws" service="gardeshPay" name="gardeshPay" source="cmsDbService"
                        procedurename="sbserviceprocedure1" preview="">
                        <member name="m1" method="verify" sort="random" preview="">
                            <params>
                                <param name="trackingNumber" value="[##cms.query.trackingNumber##]" />
                            </params>
                        </member>
                    </basis>
                    <basis core="group" name="json">
                        <basis core="inlinesource" name="db">
                            <member name="answer" format="json"
                                postsql="select value from [db.answer] where field = 'answer'" preview="">
                                {"root":[##gardeshPay.m1.result##]}
                            </member>
                            <member name="token" format="json"
                                postsql="select value from [db.token] where field = 'success'" preview="">
                                {"root":[##db.answer.Value##]}
                            </member>
                            <member name="data" format="json" postsql="select value from [db.data] where field = 'data'"
                                preview="">
                                {"root":[##db.answer.Value##]}
                            </member>
                            <member name="cardNumber" format="json"
                                postsql="select value from [db.cardNumber] where field = 'cardNumber'" preview="">
                                {"root":[##db.answer.Value##]}
                            </member>
                            <member name="hashedCardNumber" format="json"
                                postsql="select value from [db.hashedCardNumber] where field = 'hashedCardNumber'"
                                preview="">
                                {"root":[##db.answer.Value##]}
                            </member>
                            <member name="refNumber" format="json"
                                postsql="select value from [db.refNumber] where field = 'refNumber'" preview="">
                                {"root":[##db.answer.Value##]}
                            </member>
                        </basis>
                        <basis core="group" if="'[##db.token.Value##]' = 'true'">
                            <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                        </basis>
                        <basis core="group" if="'[##db.token.Value##]' <> 'true'">
                            <div class="alert-Txt">پرداخت ناموفق است</div>
                            <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                        </basis>
                        <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                            <input type="hidden" value='[##db.token.Value##]' name="token" />
                            <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                            <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                            <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                            <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                            <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                            <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                            <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                            <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                            <input type="hidden" value="[##cms.query.invoiceNumber##]" name="invoiceNumber" />
                            <input type="hidden" value="[##db.cardNumber.Value##]" name="cardNumber" />
                            <input type="hidden" value="[##db.hashedCardNumber.Value##]" name="hashedCardNumber" />
                            <input type="hidden" value="[##db.refNumber.Value##]" name="refNumber" />
                            <input type="hidden" value="[##db.get_inputs_paymentid.value##]" name="paymentid" />
                        </form>
                    </basis>
                    <script type="text/javascript">
                        // $(window).load(function(){
                        var url = "/Panel_Final_Payment.bc";
                        $.ajax({
                            type: "POST",
                            url: url,
                            data: $(".formbank").serialize(),
                            dataType: "html",
                            success: function (response) {
                                $(".sectionInfo").empty().html(response);
                                window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                            }
                        });
                        // });
                    </script>
                </basis>
                <basis core="group" name="kipaa" if="[##db.get_inputs_bank_id.Value##] = 51">
                    <basis core="inlinesource" name="db">
                        <member name="token" format="json" postsql="select value from [db.token] where field = 'token'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="kipaaPayment">
                        <basis core="external.ws.ws" service="kipaaPayment" name="kipaa" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="">
                            <member name="m1" method="verify_transaction" sort="random" preview="">
                                <params>
                                    <param name="payment_token" value="[##db.get_inputs_id.Value##]" />
                                    <param name="reciept_number" value="[##cms.form.reciept_number##]" />
                                    <param name="token" value="[##db.token.Value##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="answer" format="json"
                                    postsql="select value from [db.answer] where field = 'answer'" preview="">
                                    {"root":[##kipaa.m1.result##]}
                                </member>
                                <member name="Success" format="json"
                                    postsql="select value from [db.Success] where field = 'Success'" preview="">
                                    {"root":[##db.answer.Value##]}
                                </member>
                                <member name="CallingID" format="json"
                                    postsql="select value from [db.CallingID] where field = 'CallingID'" preview="">
                                    {"root":[##db.answer.Value##]}
                                </member>
                            </basis>
                            <basis core="group" if="'[##db.Success.Value##]' = 'true'">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group" if="'[##db.Success.Value##]' <> 'true'">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.Success.Value##]' name="token" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##db.CallingID.Value##]" name="CallingID" />
                            </form>

                        </basis>
                        <script type="text/javascript">
                            //   $(window).load(function(){
                            var url = "/Panel_Final_Payment.bc";
                            $.ajax({
                                type: "POST",
                                url: url,
                                data: $(".formbank").serialize(),
                                dataType: "html",
                                success: function (response) {
                                    $(".sectionInfo").empty().html(response);
                                    window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                }
                            });
                            //   });
                        </script>
                    </basis>

                </basis>
                <basis core="group" name="Sepah" if="[##db.get_inputs_bank_id.Value##] = 54">
                    <basis core="inlinesource" name="db">
                        <member name="token" format="json" postsql="select value from [db.token] where field = 'token'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="Sepah">
                        <basis core="external.ws.ws" service="newSepah" name="sepah" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="">
                            <member name="m1" method="ConfirmPayment" sort="random" preview="">
                                <params>
                                    <param name="LoginAccount" value="[##db.token.Value##]" />
                                    <param name="Token" value="[##cms.form.Token##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="Status" format="json"
                                    postsql="select value from [db.Status] where field = 'Status'" preview="">
                                    {"root":[##sepah.m1.result##]}
                                </member>
                                <member name="CardNumberMasked" format="json"
                                    postsql="select value from [db.CardNumberMasked] where field = 'CardNumberMasked'"
                                    preview="">
                                    {"root":[##sepah.m1.result##]}
                                </member>
                                <member name="RRN" format="json"
                                    postsql="select value from [db.RRN] where field = 'RRN'" preview="">
                                    {"root":[##sepah.m1.result##]}
                                </member>
                            </basis>
                            <basis core="group" if="'[##db.Status.Value##]' = 'false'">
                                <basis core="group" if="'[##db.RRN.Value##]' <> 'false' ">
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>

                            </basis>
                            <basis core="group" if="'[##db.Status.Value##]' <> 'false'">
                                <basis core="group" if="'[##db.RRN.Value##]' ='false'">
                                    <div class="alert-Txt">پرداخت ناموفق است</div>
                                    <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                                </basis>

                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.Status.Value##]' name="token" />
                                <input type="hidden" value='[##db.RRN.Value##]' name="RRN" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##db.CardNumberMasked.Value##]" name="CardNumberMasked" />
                                <input type="hidden" value="[##db.RRN.Value##]" name="RRN" />
                            </form>
                        </basis>
                        <script type="text/javascript">
                            // $(window).load(function(){
                            var url = "/Panel_Final_Payment.bc";
                            $.ajax({
                                type: "POST",
                                url: url,
                                data: $(".formbank").serialize(),
                                dataType: "html",
                                success: function (response) {
                                    $(".sectionInfo").empty().html(response);
                                    window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                }
                            });
                            // });
                        </script>
                    </basis>
                </basis>
                <basis core="group" name="aghayePardakht" if="[##db.get_inputs_bank_id.Value##] = 55">
                    <basis core="inlinesource" name="db">
                        <member name="token" format="json" postsql="select value from [db.token] where field = 'token'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="aghayePardakht">
                        <basis core="external.ws.ws" service="aghayePardakht" name="aghayePardakht"
                            source="cmsDbService" procedurename="sbserviceprocedure1">
                            <member name="m1" method="verify" sort="random" preview="">
                                <params>
                                    <param name="pin" value="[##db.token.Value##]" />
                                    <param name="amount" value="[##db.get_inputs_totalfinal.Value##]" />
                                    <param name="transid" value="[##cms.form.transid##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="response" format="json"
                                    postsql="select value from [db.response] where field = 'response'" preview="">
                                    {"root":[##aghayePardakht.m1.result##]}
                                </member>
                            </basis>
                            <basis core="group" if="'[##db.response.Value##]' = '1'">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group" if="'[##db.response.Value##]' <> '1'">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.response.Value##]' name="token" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##cms.form.cardnumber##]" name="cardnumber" />
                                <input type="hidden" value="[##cms.form.tracking_number##]" name="tracking_number" />
                            </form>

                        </basis>
                        <script type="text/javascript">
                            // $(window).load(function(){
                            var url = "/Panel_Final_Payment.bc";
                            $.ajax({
                                type: "POST",
                                url: url,
                                data: $(".formbank").serialize(),
                                dataType: "html",
                                success: function (response) {
                                    $(".sectionInfo").empty().html(response);
                                    window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                }
                            });
                            // });
                        </script>
                    </basis>
                </basis>
                <basis core="group" name="ayandeh" if="[##db.get_inputs_bank_id.Value##] = 57">
                    <basis core="inlinesource" name="db">
                        <member name="username" format="json"
                            postsql="select value from [db.username] where field = 'username'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="password" format="json"
                            postsql="select value from [db.password] where field = 'password'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="ayandehall">
                        <basis core="external.ws.ws" service="ayandeh" name="ayandeh" source="cmsDbService"
                            procedurename="sbserviceprocedure1">
                            <member name="m1" method="verify" sort="random" preview="">
                                <params>
                                    <param name="username" value="[##db.username.Value##]" />
                                    <param name="password" value="[##db.password.Value##]" />
                                    <param name="traceNumber" value="[##cms.form.traceNumber##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="result" format="json"
                                    postsql="select value from [db.result] where field = 'result'">
                                    {"root":[##ayandeh.m1.result##]} </member>
                                <member name="doTime" format="json"
                                    postsql="select value from [db.doTime] where field = 'doTime'">
                                    {"root":[##ayandeh.m1.result##]} </member>
                                <member name="description" format="json"
                                    postsql="select value from [db.description] where field = 'description'">
                                    {"root":[##ayandeh.m1.result##]} </member>
                            </basis>
                            <basis core="group" if="'[##db.result.Value##]' = '0'">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group" if="'[##db.result.Value##]' <> '0'">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.result.Value##]' name="token" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##cms.form.cardnumber##]" name="cardnumber" />
                                <input type="hidden" value="[##cms.form.traceNumber##]" name="traceNumber" />
                            </form>

                        </basis>
                        <script type="text/javascript">
                            // $(window).load(function () {
                            var url = "/Panel_Final_Payment.bc";
                            $.ajax({
                                type: "POST",
                                url: url,
                                data: $(".formbank").serialize(),
                                dataType: "html",
                                success: function (response) {
                                    $(".sectionInfo").empty().html(response);
                                    window.location =
                                        '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                }
                            });
                            // });
                        </script>
                    </basis>
                </basis>
                <basis core="group" name="refah" if="[##db.get_inputs_bank_id.Value##] = 65">
                    <basis core="inlinesource" name="db">
                        <member name="terminalid" format="json"
                            postsql="select value from [db.terminalid] where field = 'terminalid'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="refah">
                        <basis core="external.ws.ws" service="refah" name="refah" source="cmsDbService"
                            procedurename="sbserviceprocedure1">
                            <member name="m1" method="verifyTransaction" sort="random" preview="">
                                <params>
                                    <param name="َAction" value="verifyTransaction" />
                                    <param name="RefNum" value="[##cms.query.RefNum##]" />
                                    <param name="TerminalId" value="[##db.terminalid.Value##]" />
                                    <param name="AffectiveAmount" value="[##db.get_inputs_totalfinal.Value##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="status" format="json"
                                    postsql="select value from [db.status] where field = 'status'" preview="">
                                    {"root":[##refah.m1.result##]}
                                </member>
                            </basis>
                            <basis core="group" if="'[##db.status.Value##]' = 'true'">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group" if="'[##db.status.Value##]' <> 'true'">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.status.Value##]' name="token" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##cms.query.SecurePan##]" name="SecurePan" />
                                <input type="hidden" value="[##cms.query.HashedCardNumber##]" name="HashedCardNumber" />
                                <input type="hidden" value="[##cms.query.TraceNo##]" name="TraceNo" />
                                <input type="hidden" value="[##cms.query.Token##]" name="TokenBank" />
                            </form>
                        </basis>
                        <script type="text/javascript">
                            $(document).ready(function () {
                                var url = "/Panel_Final_Payment.bc";
                                $.ajax({
                                    type: "POST",
                                    url: url,
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                        window.location =
                                            '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                    }
                                });
                            });
                            $(".amount").text(function (index, value) {
                                return value
                                    .replace(/\D/g, "")
                                    .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            });
                        </script>
                    </basis>
                </basis>
                <basis core="group" name="shahr" if="[##db.get_inputs_bank_id.Value##] = 66">
                    <basis core="inlinesource" name="db">
                        <member name="usr" format="json" postsql="select value from [db.usr] where field = 'usr'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="pwd" format="json" postsql="select value from [db.pwd] where field = 'pwd'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="shahr">
                        <basis core="external.ws.ws" service="shahrBank" name="shahr" source="cmsDbService"
                            procedurename="sbserviceprocedure1">
                            <member name="m1" method="verify" sort="random" preview="">
                                <params>
                                    <param name="usr" value="[##db.usr.value##]" />
                                    <param name="pwd" value="[##db.pwd.value##]" />
                                    <param name="merchantConfigurationId"
                                        value="[##cms.query.merchantConfigurationId##]" />
                                    <param name="localInvoiceId" value="[##cms.query.localInvoiceId##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="Status" format="json"
                                    postsql="select value from [db.Status] where field = 'Status'" preview="">
                                    {"root":[##shahr.m1.result##]}
                                </member>
                            </basis>
                            <basis core="group" if="'[##db.Status.Value##]' = '200'">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group" if="'[##db.Status.Value##]' <> '200'">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.Status.Value##]' name="token" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##cms.query.merchantConfigurationId##]"
                                    name="merchantConfigurationId" />
                                <input type="hidden" value="[##cms.query.localInvoiceId##]" name="localInvoiceId" />
                                <input type="hidden" value="[##cms.form.PayGateTranID##]" name="PayGateTranID" />
                            </form>
                        </basis>
                        <script type="text/javascript">
                            $(document).ready(function () {
                                var url = "/Panel_Final_Payment.bc";
                                $.ajax({
                                    type: "POST",
                                    url: url,
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                        window.location =
                                            '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                    }
                                });
                            });
                            $(".amount").text(function (index, value) {
                                return value
                                    .replace(/\D/g, "")
                                    .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            });
                        </script>
                    </basis>
                </basis>
                <basis core="group" name="fadax" if="[##db.get_inputs_bank_id.Value##] = 69">
                    <basis core="inlinesource" name="db">
                        <member name="get_inputs_paymentToken" format="json"
                            postsql="select  value  from [db.get_inputs_paymentToken] as a where Field = 'paymentToken'"
                            preview="">
                            {"root":[##db.get_inputs.result##]}</member>
                        <member name="get_inputs_token_jwt" format="json"
                            postsql="select  value  from [db.get_inputs_token_jwt] as a where Field = 'token_jwt'"
                            preview="">
                            {"root":[##db.get_inputs.result##]}</member>
                    </basis>
                    <basis core="group" name="fadax">
                        <basis core="external.ws.ws" service="fadaxPayment" name="fadax" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="true">
                            <member name="m1" method="verify" sort="random" preview="">
                                <params>
                                    <param name="paymentToken" value="[##db.get_inputs_paymentToken.Value##]" />
                                    <param name="token_jwt" value="[##db.get_inputs_token_jwt.Value##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="verify" format="json"
                                    postsql="select value from [db.verify] where field = 'verify'" preview="">
                                    {"root":[##fadax.m1.result##]}
                                </member>
                                <member name="success" format="json"
                                    postsql="select value from [db.success] where field = 'success'" preview="">
                                    {"root":[##db.verify.Value##]}
                                </member>
                                <member name="transactionId" format="json"
                                    postsql="select value from [db.transactionId] where field = 'transactionId'"
                                    preview="">
                                    {"root":[##fadax.m1.result##]}
                                </member>
                            </basis>

                            <basis core="group"
                                if="'[##db.success.Value##]' = 'true' and '[##db.transactionId.Value##]' <> ''">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group"
                                if="'[##db.success.Value##]' <> 'true' and '[##db.transactionId.Value##]' = ''">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.success.Value##]' name="token" />
                                <input type="hidden" value='[##db.transactionId.Value##]' name="transactionId" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##db.transactionId.Value##]"
                                    name="fadax_tracking_number" />
                            </form>
                        </basis>
                        <script type="text/javascript">
                            $(document).ready(function () {
                                var url = "/Panel_Final_Payment.bc";
                                $.ajax({
                                    type: "POST",
                                    url: url,
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                        window.location =
                                            '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                    }
                                });
                            });
                            $(".amount").text(function (index, value) {
                                return value
                                    .replace(/\D/g, "")
                                    .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            });
                        </script>
                    </basis>
                </basis>
                <basis core="group" name="fadaxMellat" if="[##db.get_inputs_bank_id.Value##] = 199">
                    <basis core="inlinesource" name="db">
                        <member name="get_inputs_paymentToken" format="json"
                            postsql="select  value  from [db.get_inputs_paymentToken] as a where Field = 'paymentToken'"
                            preview="">
                            {"root":[##db.get_inputs.result##]}</member>
                        <member name="get_inputs_token_jwt" format="json"
                            postsql="select  value  from [db.get_inputs_token_jwt] as a where Field = 'token_jwt'"
                            preview="">
                            {"root":[##db.get_inputs.result##]}</member>
                    </basis>
                    <basis core="group" name="fadaxMellat">
                        <basis core="external.ws.ws" service="fadaxMellat" name="fadax" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="true">
                            <member name="m1" method="verify" sort="random" preview="">
                                <params>
                                    <param name="paymentToken" value="[##db.get_inputs_paymentToken.Value##]" />
                                    <param name="token_jwt" value="[##db.get_inputs_token_jwt.Value##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="verify" format="json"
                                    postsql="select value from [db.verify] where field = 'verify'" preview="">
                                    {"root":[##fadax.m1.result##]}
                                </member>
                                <member name="success" format="json"
                                    postsql="select value from [db.success] where field = 'success'" preview="">
                                    {"root":[##db.verify.Value##]}
                                </member>
                                <member name="transactionId" format="json"
                                    postsql="select value from [db.transactionId] where field = 'transactionId'"
                                    preview="">
                                    {"root":[##fadax.m1.result##]}
                                </member>
                            </basis>

                            <basis core="group"
                                if="'[##db.success.Value##]' = 'true' and '[##db.transactionId.Value##]' <> ''">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group"
                                if="'[##db.success.Value##]' <> 'true' and '[##db.transactionId.Value##]' = ''">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.success.Value##]' name="token" />
                                <input type="hidden" value='[##db.transactionId.Value##]' name="transactionId" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##db.transactionId.Value##]"
                                    name="fadax_tracking_number" />
                            </form>
                        </basis>
                        <script type="text/javascript">
                            $(document).ready(function () {
                                var url = "/Panel_Final_Payment.bc";
                                $.ajax({
                                    type: "POST",
                                    url: url,
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                        window.location =
                                            '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                    }
                                });
                            });
                            $(".amount").text(function (index, value) {
                                return value
                                    .replace(/\D/g, "")
                                    .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            });
                        </script>
                    </basis>
                </basis>
                <basis core="group" name="pasargad2" if="[##db.get_inputs_bank_id.Value##] = 95">
                    <basis core="inlinesource" name="db">
                        <member name="username" format="json"
                            postsql="select value from [db.username] where field = 'username'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="password" format="json"
                            postsql="select value from [db.password] where field = 'password'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="get_inputs_urlId" format="json"
                            postsql="select  value  from [db.get_inputs_urlId] as a where Field = 'urlId'" preview="">
                            {"root":[##db.get_inputs.result##]}</member>
                    </basis>
                    <basis core="group" name="pasargad2g">
                        <basis core="external.ws.ws" service="pasargad2" name="pasargad_verify" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="true">
                            <member name="m1" method="verify" sort="random" preview="">
                                <params>
                                    <param name="paymentid" value="[##db.get_inputs_paymentid.Value##]" />
                                    <param name="urlId" value="[##db.get_inputs_urlId.Value##]" />
                                    <param name="username" value="[##db.username.Value##]" />
                                    <param name="password" value="[##db.password.Value##]" />
                                    <param name="dmnid" value="[##db.dmnid.dmnid##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="Status" format="json"
                                    postsql="select  value  from [db.Status] as a where field = 'resultCode'" preview="">
                                    {"root":[##pasargad_verify.m1.result##]}</member>
                            </basis>

                            <basis core="group" if="'[##cms.query.status##]'= 'success'">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group" if="'[##cms.query.status##]' <> 'success'">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##cms.query.status##]' name="token" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##cms.query.referenceNumber##]" name="referenceNumber" />
                                <input type="hidden" value="[##cms.query.invoiceId##]" name="invoiceId" />
                            </form>
                        </basis>
                        <script type="text/javascript">
                            $(document).ready(function () {
                                var url = "/Panel_Final_Payment.bc";
                                $.ajax({
                                    type: "POST",
                                    url: url,
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                        window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                    }
                                });
                            });
                            $(".amount").text(function (index, value) {
                                return value
                                    .replace(/\D/g, "")
                                    .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            });
                        </script>
                    </basis>
                </basis>
                <basis core="group" name="Rayancard" if="[##db.get_inputs_bank_id.Value##] = 73">
                    <basis core="inlinesource" name="db">
                        <member name="password" format="json"
                            postsql="select value from [db.password] where field = 'password'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="Rayan">
                        <basis core="external.ws.ws" service="rayanCardPayment" name="rayancard" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="true">
                            <member name="m1" method="verify" sort="random">
                                <params>
                                    <param name="token" value="[##cms.form.token##]" />
                                    <param name="password" value="[##db.password.Value##]" />
                                    <param name="verify" value="[##cms.form.orderId##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="status" format="json"
                                    postsql="select value from [db.status] where field = 'wasSuccessful'" preview="">
                                    {"root":[##rayancard.m1.result##]}
                                </member>
                                <member name="cardNumber" format="json"
                                    postsql="select  Value  from [db.cardNumber] where field = 'cardMaskPan'"
                                    preview="">
                                    {"root":[##rayancard.m1.result##]}</member>
                                <member name="transId" format="json"
                                    postsql="select  Value  from [db.transId] where field = 'orderId'" preview="">
                                    {"root":[##rayancard.m1.result##]}</member>
                            </basis>
                            <basis core="group" if="'[##db.status.Value##]' = 'true'">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group" if="'[##db.status.Value##]' <> 'true'">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.status.Value##]' name="token" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##db.cardNumber.Value##]" name="SecurePan" />
                                <input type="hidden" value="[##db.transId.Value##]" name="transId" />
                                <input type="hidden" value="[##cms.form.token##]" name="TokenBank" />
                            </form>
                        </basis>
                        <script type="text/javascript">
                            $(document).ready(function () {
                                var url = "/Panel_Final_Payment.bc";
                                $.ajax({
                                    type: "POST",
                                    url: url,
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                        window.location =
                                            '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                    }
                                });
                            });
                            $(".amount").text(function (index, value) {
                                return value
                                    .replace(/\D/g, "")
                                    .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            });
                        </script>
                    </basis>
                </basis>
                <basis core="group" name="IranKishcard" if="[##db.get_inputs_bank_id.Value##] = 77">
                    <basis core="inlinesource" name="db">
                        <member name="terminalid" format="json"
                            postsql="select value from [db.terminalid] where field = 'terminalid'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="IranKish">
                        <basis core="external.ws.ws" service="IranKishPayment" name="irankish" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="">
                            <member name="m1" method="verify" sort="random">
                                <params>
                                    <param name="terminalId" value="[##db.terminalid.Value##]" />
                                    <param name="retrievalReferenceNumber"
                                        value="[##cms.form.retrievalReferenceNumber##]" />
                                    <param name="systemTraceAuditNumber"
                                        value="[##cms.form.systemTraceAuditNumber##]" />
                                    <param name="tokenIdentity" value="[##cms.form.token##]" />
                                </params>
                            </member>
                        </basis>

                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="status" format="json"
                                    postsql="select  Value  from [db.status] where field = 'status'" preview="">
                                    {"root":[##irankish.m1.result##]}</member>
                                <member name="systemTraceAuditNumber" format="json"
                                    postsql="select  Value  from [db.systemTraceAuditNumber] where field = 'systemTraceAuditNumber'"
                                    preview="">
                                    {"root":[##irankish.m1.result##]}</member>
                            </basis>
                            <basis core="group" if="'[##db.status.Value##]' = 'true'">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group" if="'[##db.status.Value##]' <> 'true'">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.status.Value##]' name="token" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##cms.form.maskedPan##]" name="SecurePan" />
                                <input type="hidden" value="[##db.systemTraceAuditNumber.Value##]"
                                    name="systemTraceAuditNumber" />
                                <input type="hidden" value="[##cms.form.token##]" name="TokenBank" />
                                <input type="hidden" value="[##cms.form.merchantId##]" name="merchantid" />
                            </form>
                        </basis>
                        <script type="text/javascript">
                            $(document).ready(function () {
                                var url = "/Panel_Final_Payment.bc";
                                $.ajax({
                                    type: "POST",
                                    url: url,
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                        window.location =
                                            '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                    }
                                });
                            });
                            $(".amount").text(function (index, value) {
                                return value
                                    .replace(/\D/g, "")
                                    .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            });
                        </script>
                    </basis>
                </basis>
                <basis core="group" name="BasaPayment" if="[##db.get_inputs_bank_id.Value##] = 85">
                    <basis core="inlinesource" name="db">
                        <member name="password" format="json"
                            postsql="select value from [db.password] where field = 'password'">
                            {"root":[##db.webservice_detail.result##]} </member>
                    </basis>
                    <basis core="group" name="Rayan">
                        <basis core="external.ws.ws" service="basaPayment" name="basa" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="true">
                            <member name="m1" method="verify" sort="random">
                                <params>
                                    <param name="token" value="[##cms.form.token##]" />
                                    <param name="password" value="[##db.password.Value##]" />
                                    <param name="verify" value="[##cms.form.orderId##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="status" format="json"
                                    postsql="select value from [db.status] where field = 'wasSuccessful'" preview="">
                                    {"root":[##basa.m1.result##]}
                                </member>
                                <member name="cardNumber" format="json"
                                    postsql="select  Value  from [db.cardNumber] where field = 'cardMaskPan'"
                                    preview="">
                                    {"root":[##basa.m1.result##]}</member>
                                <member name="transId" format="json"
                                    postsql="select  Value  from [db.transId] where field = 'orderId'" preview="">
                                    {"root":[##basa.m1.result##]}</member>
                            </basis>
                            <basis core="group" if="'[##db.status.Value##]' = 'true'">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group" if="'[##db.status.Value##]' <> 'true'">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.status.Value##]' name="token" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                                <input type="hidden" value="[##db.cardNumber.Value##]" name="SecurePan" />
                                <input type="hidden" value="[##db.transId.Value##]" name="transId" />
                                <input type="hidden" value="[##cms.form.token##]" name="TokenBank" />
                            </form>
                        </basis>
                        <script type="text/javascript">
                            $(document).ready(function () {
                                var url = "/Panel_Final_Payment.bc";
                                $.ajax({
                                    type: "POST",
                                    url: url,
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                        window.location =
                                            '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                    }
                                });
                            });
                            $(".amount").text(function (index, value) {
                                return value
                                    .replace(/\D/g, "")
                                    .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            });
                        </script>
                    </basis>
                </basis>
                <basis core="group" name="siBank" if="[##db.get_inputs_bank_id.Value##] = 97">
                    <basis core="inlinesource" name="db">
                        <member name="username" format="json"
                            postsql="select value from [db.username] where field = 'username'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="password" format="json"
                            postsql="select value from [db.password] where field = 'password'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="merchant" format="json"
                            postsql="select value from [db.merchant] where field = 'merchant'">
                            {"root":[##db.webservice_detail.result##]} </member>
                        <member name="get_inputs_transaction_id" format="json"
                            postsql="select  value  from [db.get_inputs_transaction_id] as a where Field = 'transaction_id'"
                            preview="">
                            {"root":[##db.get_inputs.result##]}</member>
                    </basis>
                    <basis core="group" name="siBankg">
                        <basis core="external.ws.ws" service="siBank" name="si" source="cmsDbService"
                            procedurename="sbserviceprocedure1" preview="true">
                            <member name="m1" method="verify" sort="random">
                                <params>
                                    <param name="transaction_id" value="[##db.get_inputs_transaction_id.Value##]" />
                                    <param name="username" value="[##db.username.Value##]" />
                                    <param name="password" value="[##db.password.Value##]" />
                                    <param name="merchant" value="[##db.merchant.Value##]" />
                                </params>
                            </member>
                        </basis>
                        <basis core="group" name="json">
                            <basis core="inlinesource" name="db">
                                <member name="Status" format="json"
                                    postsql="select  value  from [db.Status] as a where field = 'success'" preview="">
                                    {"root":[##si.m1.result##]}</member>
                            </basis>
                            <basis core="group" if="'[##db.Status.Value##]' = 'true'">
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <basis core="group" if="'[##db.Status.Value##]' <> 'true'">
                                <div class="alert-Txt">پرداخت ناموفق است</div>
                                <div class="alert-Txt">...در حال بارگیری اطلاعات لطفا صبر کنید</div>
                            </basis>
                            <form method="post" action="/Panel_Final_Payment.bc" name="formbank" class="formbank">
                                <input type="hidden" value='[##db.Status.Value##]' name="token" />
                                <input type="hidden" value="[##db.userid.userid##]" name="userid" />
                                <input type="hidden" value="[##db.dmnid.dmnid##]" name="dmnid" />
                                <input type="hidden" value="[##db.get_inputs_factorid.Value##]" name="factorid" />
                                <input type="hidden" value="[##db.get_inputs_agencyid.Value##]" name="agencyid" />
                                <input type="hidden" value="[##db.get_inputs_supplier.Value##]" name="supplier" />
                                <input type="hidden" value="[##db.get_inputs_paytype.Value##]" name="paytype" />
                                <input type="hidden" value="[##db.get_inputs_trackingid.Value##]" name="trackingid" />
                                <input type="hidden" value="[##db.get_inputs_bank_id.Value##]" name="bank_id" />
                                <input type="hidden" value="[##db.get_inputs_paymentid.Value##]" name="paymentid" />
                            </form>
                        </basis>
                        <script type="text/javascript">
                            $(document).ready(function () {
                                var url = "/Panel_Final_Payment.bc";
                                $.ajax({
                                    type: "POST",
                                    url: url,
                                    data: $(".formbank").serialize(),
                                    dataType: "html",
                                    success: function (response) {
                                        $(".sectionInfo").empty().html(response);
                                        window.location = '[##site.address.domain##]/Panel-InvoiceView.bc?id=[##db.get_inputs_factorid.Value##]&open=0'
                                    }
                                });
                            });
                            $(".amount").text(function (index, value) {
                                return value
                                    .replace(/\D/g, "")
                                    .replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                            });
                        </script>
                    </basis>
                </basis>
            </div>
        </body>

        </html>